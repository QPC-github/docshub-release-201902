
<!DOCTYPE HTML>

<html lang="en">

<head>
  <meta charset="utf-8">
  <title>Posixfile - Python 2.7 - W3cubDocs</title>
  
  <meta name="description" content=" Deprecated since version 1.5&#58; The locking operation that this module provides is done better and more portably by the fcntl.lockf() call. ">
  <meta name="keywords" content="posixfile, —, file-like, objects, with, locking, support, -, python, python~2.7">
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="mobile-web-app-capable" content="yes">
  
  <link rel="canonical" href="http://docs.w3cub.com/python~2.7/library/posixfile/">
  <link href="/favicon.png" rel="icon">
  <link rel="stylesheet" type="text/css" href="/assets/application-6cc8ff3c95d062e2cd87636799240e79e4553263ad7de9cda9464063203db436.css" integrity="sha256-bMj/PJXQYuLNh2NnmSQOeeRVMmOtfenNqUZAYyA9tDY=" crossorigin="anonymous">
  <script type="text/javascript" integrity="sha256-JOOcjTvTbt5QE9AmOH1rrXz8aKKfHMsOthbsjt9CNfk=" crossorigin="anonymous" src="/assets/application-24e39c8d3bd36ede5013d026387d6bad7cfc68a29f1ccb0eb616ec8edf4235f9.js"></script>
  <script src="/json/python~2.7.js"></script>
  
  <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-71174418-1']);
    _gaq.push(['_trackPageview']);

    (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
  </script>


</head>

<body>
	<div class="_app">
	<header class="_header">
  
  <form class="_search">
    <input type="search" class="_search-input" placeholder="Search&hellip;" autocomplete="off" autocapitalize="off" autocorrect="off" spellcheck="false" maxlength="20">
    <a class="_search-clear"></a>
    <div class="_search-tag"></div>
  </form>
  
  <a class="_home-link" href="/" ></a>
  <a class="_menu-link"></a>
  <h1 class="_logo">
    <a href="/" class="_nav-link" title="API Documentation Browser">W3cubDocs</a>
  </h1>
  
  <span class="_logo-sub-nav">/</span><span class="_logo-sub-nav"><a href="/python~2.7/" class="_nav-link" title="" style="margin-left:0;">Python 2.7</a></span>
  
  <nav class="_nav">
    <a href="/app/" class="_nav-link ">App</a>
    <a href="/about/" class="_nav-link ">About</a>
  </nav>
</header>
	<section class="_sidebar">
		<div class="_list">
			
		</div>
	</section>
	<section class="_container ">
		<div class="_content">
			<div class="_page _sphinx">
				<script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
<!-- 文档开头内嵌 -->
<ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-2572770204602497"
     data-ad-slot="8852552735"
     data-ad-format="auto"
     data-full-width-responsive="true"></ins>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script>
				
<h1 id="posixfile-file-like-objects-with-locking-support"> posixfile — File-like objects with locking support</h1> <div class="deprecated" id="module-posixfile"> <p><span class="versionmodified">Deprecated since version 1.5: </span>The locking operation that this module provides is done better and more portably by the <a class="reference internal" href="../fcntl/#fcntl.lockf" title="fcntl.lockf"><code>fcntl.lockf()</code></a> call.</p> </div> <p id="index-1">This module implements some additional functionality over the built-in file objects. In particular, it implements file locking, control over the file flags, and an easy interface to duplicate the file object. The module defines a new file object, the posixfile object. It has all the standard file object methods and adds the methods described below. This module only works for certain flavors of Unix, since it uses <a class="reference internal" href="../fcntl/#fcntl.fcntl" title="fcntl.fcntl"><code>fcntl.fcntl()</code></a> for file locking.</p> <p>To instantiate a posixfile object, use the <a class="reference internal" href="#posixfile.open" title="posixfile.open"><code>posixfile.open()</code></a> function. The resulting object looks and feels roughly the same as a standard file object.</p> <p>The <a class="reference internal" href="#module-posixfile" title="posixfile: A file-like object with support for locking. (deprecated) (Unix)"><code>posixfile</code></a> module defines the following constants:</p> <dl class="data"> <dt id="posixfile.SEEK_SET">
<code>posixfile.SEEK_SET</code> </dt> <dd>
<p>Offset is calculated from the start of the file.</p> </dd>
</dl> <dl class="data"> <dt id="posixfile.SEEK_CUR">
<code>posixfile.SEEK_CUR</code> </dt> <dd>
<p>Offset is calculated from the current position in the file.</p> </dd>
</dl> <dl class="data"> <dt id="posixfile.SEEK_END">
<code>posixfile.SEEK_END</code> </dt> <dd>
<p>Offset is calculated from the end of the file.</p> </dd>
</dl> <p>The <a class="reference internal" href="#module-posixfile" title="posixfile: A file-like object with support for locking. (deprecated) (Unix)"><code>posixfile</code></a> module defines the following functions:</p> <dl class="function"> <dt id="posixfile.open">
<code>posixfile.open(filename[, mode[, bufsize]])</code> </dt> <dd>
<p>Create a new posixfile object with the given filename and mode. The <em>filename</em>, <em>mode</em> and <em>bufsize</em> arguments are interpreted the same way as by the built-in <a class="reference internal" href="../functions/#open" title="open"><code>open()</code></a> function.</p> </dd>
</dl> <dl class="function"> <dt id="posixfile.fileopen">
<code>posixfile.fileopen(fileobject)</code> </dt> <dd>
<p>Create a new posixfile object with the given standard file object. The resulting object has the same filename and mode as the original file object.</p> </dd>
</dl> <p>The posixfile object defines the following additional methods:</p> <dl class="method"> <dt id="posixfile.posixfile.lock">
<code>posixfile.lock(fmt[, len[, start[, whence]]])</code> </dt> <dd>
<p>Lock the specified section of the file that the file object is referring to. The format is explained below in a table. The <em>len</em> argument specifies the length of the section that should be locked. The default is <code>0</code>. <em>start</em> specifies the starting offset of the section, where the default is <code>0</code>. The <em>whence</em> argument specifies where the offset is relative to. It accepts one of the constants <a class="reference internal" href="#posixfile.SEEK_SET" title="posixfile.SEEK_SET"><code>SEEK_SET</code></a>, <a class="reference internal" href="#posixfile.SEEK_CUR" title="posixfile.SEEK_CUR"><code>SEEK_CUR</code></a> or <a class="reference internal" href="#posixfile.SEEK_END" title="posixfile.SEEK_END"><code>SEEK_END</code></a>. The default is <a class="reference internal" href="#posixfile.SEEK_SET" title="posixfile.SEEK_SET"><code>SEEK_SET</code></a>. For more information about the arguments refer to the <em class="manpage">fcntl(2)</em> manual page on your system.</p> </dd>
</dl> <dl class="method"> <dt id="posixfile.posixfile.flags">
<code>posixfile.flags([flags])</code> </dt> <dd>
<p>Set the specified flags for the file that the file object is referring to. The new flags are ORed with the old flags, unless specified otherwise. The format is explained below in a table. Without the <em>flags</em> argument a string indicating the current flags is returned (this is the same as the <code>?</code> modifier). For more information about the flags refer to the <em class="manpage">fcntl(2)</em> manual page on your system.</p> </dd>
</dl> <dl class="method"> <dt id="posixfile.posixfile.dup">
<code>posixfile.dup()</code> </dt> <dd>
<p>Duplicate the file object and the underlying file pointer and file descriptor. The resulting object behaves as if it were newly opened.</p> </dd>
</dl> <dl class="method"> <dt id="posixfile.posixfile.dup2">
<code>posixfile.dup2(fd)</code> </dt> <dd>
<p>Duplicate the file object and the underlying file pointer and file descriptor. The new object will have the given file descriptor. Otherwise the resulting object behaves as if it were newly opened.</p> </dd>
</dl> <dl class="method"> <dt id="posixfile.posixfile.file">
<code>posixfile.file()</code> </dt> <dd>
<p>Return the standard file object that the posixfile object is based on. This is sometimes necessary for functions that insist on a standard file object.</p> </dd>
</dl> <p>All methods raise <a class="reference internal" href="../exceptions/#exceptions.IOError" title="exceptions.IOError"><code>IOError</code></a> when the request fails.</p> <p>Format characters for the <code>lock()</code> method have the following meaning:</p> <table class="docutils">  <thead valign="bottom"> <tr class="row-odd">
<th class="head">Format</th> <th class="head">Meaning</th> </tr> </thead>  <tr class="row-even">
<td><code>u</code></td> <td>unlock the specified region</td> </tr> <tr class="row-odd">
<td><code>r</code></td> <td>request a read lock for the specified section</td> </tr> <tr class="row-even">
<td><code>w</code></td> <td>request a write lock for the specified section</td> </tr>  </table> <p>In addition the following modifiers can be added to the format:</p> <table class="docutils">  <thead valign="bottom"> <tr class="row-odd">
<th class="head">Modifier</th> <th class="head">Meaning</th> <th class="head">Notes</th> </tr> </thead>  <tr class="row-even">
<td><code>|</code></td> <td>wait until the lock has been granted</td> <td> </td> </tr> <tr class="row-odd">
<td><code>?</code></td> <td>return the first lock conflicting with the requested lock, or <code>None</code> if there is no conflict.</td> <td>(1)</td> </tr>  </table> <p>Note:</p> <ol class="arabic simple"> <li>The lock returned is in the format <code>(mode, len, start, whence, pid)</code> where <em>mode</em> is a character representing the type of lock (‘r’ or ‘w’). This modifier prevents a request from being granted; it is for query purposes only.</li> </ol> <p>Format characters for the <code>flags()</code> method have the following meanings:</p> <table class="docutils">  <thead valign="bottom"> <tr class="row-odd">
<th class="head">Format</th> <th class="head">Meaning</th> </tr> </thead>  <tr class="row-even">
<td><code>a</code></td> <td>append only flag</td> </tr> <tr class="row-odd">
<td><code>c</code></td> <td>close on exec flag</td> </tr> <tr class="row-even">
<td><code>n</code></td> <td>no delay flag (also called non-blocking flag)</td> </tr> <tr class="row-odd">
<td><code>s</code></td> <td>synchronization flag</td> </tr>  </table> <p>In addition the following modifiers can be added to the format:</p> <table class="docutils">  <thead valign="bottom"> <tr class="row-odd">
<th class="head">Modifier</th> <th class="head">Meaning</th> <th class="head">Notes</th> </tr> </thead>  <tr class="row-even">
<td><code>!</code></td> <td>turn the specified flags ‘off’, instead of the default ‘on’</td> <td>(1)</td> </tr> <tr class="row-odd">
<td><code>=</code></td> <td>replace the flags, instead of the default ‘OR’ operation</td> <td>(1)</td> </tr> <tr class="row-even">
<td><code>?</code></td> <td>return a string in which the characters represent the flags that are set.</td> <td>(2)</td> </tr>  </table> <p>Notes:</p> <ol class="arabic simple"> <li>The <code>!</code> and <code>=</code> modifiers are mutually exclusive.</li> <li>This string represents the flags after they may have been altered by the same call.</li> </ol> <p>Examples:</p> <pre data-language="python">import posixfile

file = posixfile.open('testfile', 'w')
file.lock('w|')
...
file.lock('u')
file.close()
</pre>
<div class="_attribution">
  <p class="_attribution-p">
    © 2001–2017 Python Software Foundation<br>Licensed under the PSF License.<br>
    <a href="https://docs.python.org/2.7/library/posixfile.html" class="_attribution-link" target="_blank">https://docs.python.org/2.7/library/posixfile.html</a>
  </p>
</div>

				<script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
<!-- 文档结尾内嵌 -->
<ins class="adsbygoogle"
    style="display:block"
    data-ad-client="ca-pub-2572770204602497"
    data-ad-slot="5446239318"
    data-ad-format="auto"
    data-full-width-responsive="true"></ins>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script>
			</div>
		</div>
	</section>

	</div>
	<svg style="display:none">
		<symbol id="icon-dir"><svg viewBox="0 0 20 20"><path d="M15 10c0 .3-.305.515-.305.515l-8.56 5.303c-.625.41-1.135.106-1.135-.67V4.853c0-.777.51-1.078 1.135-.67l8.56 5.305S15 9.702 15 10z"/></svg></symbol>
	  </svg>
</body>
</html>
