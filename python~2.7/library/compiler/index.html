
<!DOCTYPE HTML>

<html lang="en">

<head>
  <meta charset="utf-8">
  <title>Python Compiler Package - Python 2.7 - W3cubDocs</title>
  
  <meta name="description" content=" Deprecated since version 2.6&#58; The compiler package has been removed in Python 3. ">
  <meta name="keywords" content="python, compiler, package, -, python~2.7">
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="mobile-web-app-capable" content="yes">
  
  <link rel="canonical" href="http://docs.w3cub.com/python~2.7/library/compiler/">
  <link href="/favicon.png" rel="icon">
  <link rel="stylesheet" type="text/css" href="/assets/application-6cc8ff3c95d062e2cd87636799240e79e4553263ad7de9cda9464063203db436.css" integrity="sha256-bMj/PJXQYuLNh2NnmSQOeeRVMmOtfenNqUZAYyA9tDY=" crossorigin="anonymous">
  <script type="text/javascript" integrity="sha256-JOOcjTvTbt5QE9AmOH1rrXz8aKKfHMsOthbsjt9CNfk=" crossorigin="anonymous" src="/assets/application-24e39c8d3bd36ede5013d026387d6bad7cfc68a29f1ccb0eb616ec8edf4235f9.js"></script>
  <script src="/json/python~2.7.js"></script>
  
  <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-71174418-1']);
    _gaq.push(['_trackPageview']);

    (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
  </script>


</head>

<body>
	<div class="_app">
	<header class="_header">
  
  <form class="_search">
    <input type="search" class="_search-input" placeholder="Search&hellip;" autocomplete="off" autocapitalize="off" autocorrect="off" spellcheck="false" maxlength="20">
    <a class="_search-clear"></a>
    <div class="_search-tag"></div>
  </form>
  
  <a class="_home-link" href="/" ></a>
  <a class="_menu-link"></a>
  <h1 class="_logo">
    <a href="/" class="_nav-link" title="API Documentation Browser">W3cubDocs</a>
  </h1>
  
  <span class="_logo-sub-nav">/</span><span class="_logo-sub-nav"><a href="/python~2.7/" class="_nav-link" title="" style="margin-left:0;">Python 2.7</a></span>
  
  <nav class="_nav">
    <a href="/app/" class="_nav-link ">App</a>
    <a href="/about/" class="_nav-link ">About</a>
  </nav>
</header>
	<section class="_sidebar">
		<div class="_list">
			
		</div>
	</section>
	<section class="_container ">
		<div class="_content">
			<div class="_page _sphinx">
				<script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
<!-- 文档开头内嵌 -->
<ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-2572770204602497"
     data-ad-slot="8852552735"
     data-ad-format="auto"
     data-full-width-responsive="true"></ins>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script>
				
<h1 id="compiler"> Python compiler package</h1> <div class="deprecated" id="python-compiler-package"> <p><span class="versionmodified">Deprecated since version 2.6: </span>The <a class="reference internal" href="#module-compiler" title="compiler: Python code compiler written in Python. (deprecated)"><code>compiler</code></a> package has been removed in Python 3.</p> </div> <p>The Python compiler package is a tool for analyzing Python source code and generating Python bytecode. The compiler contains libraries to generate an abstract syntax tree from Python source code and to generate Python <a class="reference internal" href="https://docs.python.org/2.7/glossary.html#term-bytecode" target="_blank"><span class="xref std std-term">bytecode</span></a> from the tree.</p> <p>The <a class="reference internal" href="#module-compiler" title="compiler: Python code compiler written in Python. (deprecated)"><code>compiler</code></a> package is a Python source to bytecode translator written in Python. It uses the built-in parser and standard <a class="reference internal" href="../parser/#module-parser" title="parser: Access parse trees for Python source code."><code>parser</code></a> module to generate a concrete syntax tree. This tree is used to generate an abstract syntax tree (AST) and then Python bytecode.</p> <p>The full functionality of the package duplicates the built-in compiler provided with the Python interpreter. It is intended to match its behavior almost exactly. Why implement another compiler that does the same thing? The package is useful for a variety of purposes. It can be modified more easily than the built-in compiler. The AST it generates is useful for analyzing Python source code.</p> <p>This chapter explains how the various components of the <a class="reference internal" href="#module-compiler" title="compiler: Python code compiler written in Python. (deprecated)"><code>compiler</code></a> package work. It blends reference material with a tutorial.</p>  <h2 id="the-basic-interface">1. The basic interface</h2> <p id="module-compiler">The top-level of the package defines four functions. If you import <a class="reference internal" href="#module-compiler" title="compiler: Python code compiler written in Python. (deprecated)"><code>compiler</code></a>, you will get these functions and a collection of modules contained in the package.</p> <dl class="function"> <dt id="compiler.parse">
<code>compiler.parse(buf)</code> </dt> <dd>
<p>Returns an abstract syntax tree for the Python source code in <em>buf</em>. The function raises <a class="reference internal" href="../exceptions/#exceptions.SyntaxError" title="exceptions.SyntaxError"><code>SyntaxError</code></a> if there is an error in the source code. The return value is a <code>compiler.ast.Module</code> instance that contains the tree.</p> </dd>
</dl> <dl class="function"> <dt id="compiler.parseFile">
<code>compiler.parseFile(path)</code> </dt> <dd>
<p>Return an abstract syntax tree for the Python source code in the file specified by <em>path</em>. It is equivalent to <code>parse(open(path).read())</code>.</p> </dd>
</dl> <dl class="function"> <dt id="compiler.walk">
<code>compiler.walk(ast, visitor[, verbose])</code> </dt> <dd>
<p>Do a pre-order walk over the abstract syntax tree <em>ast</em>. Call the appropriate method on the <em>visitor</em> instance for each node encountered.</p> </dd>
</dl> <dl class="function"> <dt id="compiler.compile">
<code>compiler.compile(source, filename, mode, flags=None, dont_inherit=None)</code> </dt> <dd>
<p>Compile the string <em>source</em>, a Python module, statement or expression, into a code object that can be executed by the exec statement or <a class="reference internal" href="../functions/#eval" title="eval"><code>eval()</code></a>. This function is a replacement for the built-in <a class="reference internal" href="../functions/#compile" title="compile"><code>compile()</code></a> function.</p> <p>The <em>filename</em> will be used for run-time error messages.</p> <p>The <em>mode</em> must be ‘exec’ to compile a module, ‘single’ to compile a single (interactive) statement, or ‘eval’ to compile an expression.</p> <p>The <em>flags</em> and <em>dont_inherit</em> arguments affect future-related statements, but are not supported yet.</p> </dd>
</dl> <dl class="function"> <dt id="compiler.compileFile">
<code>compiler.compileFile(source)</code> </dt> <dd>
<p>Compiles the file <em>source</em> and generates a .pyc file.</p> </dd>
</dl> <p>The <a class="reference internal" href="#module-compiler" title="compiler: Python code compiler written in Python. (deprecated)"><code>compiler</code></a> package contains the following modules: <a class="reference internal" href="../ast/#module-ast" title="ast: Abstract Syntax Tree classes and manipulation."><code>ast</code></a>, <code>consts</code>, <code>future</code>, <code>misc</code>, <code>pyassem</code>, <code>pycodegen</code>, <code>symbols</code>, <code>transformer</code>, and <code>visitor</code>.</p>   <h2 id="limitations">2. Limitations</h2> <p>There are some problems with the error checking of the compiler package. The interpreter detects syntax errors in two distinct phases. One set of errors is detected by the interpreter’s parser, the other set by the compiler. The compiler package relies on the interpreter’s parser, so it get the first phases of error checking for free. It implements the second phase itself, and that implementation is incomplete. For example, the compiler package does not raise an error if a name appears more than once in an argument list: <code>def f(x, x):
...</code></p> <p>A future version of the compiler should fix these problems.</p>   <h2 id="python-abstract-syntax">3. Python Abstract Syntax</h2> <p>The <a class="reference internal" href="#module-compiler.ast" title="compiler.ast"><code>compiler.ast</code></a> module defines an abstract syntax for Python. In the abstract syntax tree, each node represents a syntactic construct. The root of the tree is <code>Module</code> object.</p> <p>The abstract syntax offers a higher level interface to parsed Python source code. The <a class="reference internal" href="../parser/#module-parser" title="parser: Access parse trees for Python source code."><code>parser</code></a> module and the compiler written in C for the Python interpreter use a concrete syntax tree. The concrete syntax is tied closely to the grammar description used for the Python parser. Instead of a single node for a construct, there are often several levels of nested nodes that are introduced by Python’s precedence rules.</p> <p>The abstract syntax tree is created by the <code>compiler.transformer</code> module. The transformer relies on the built-in Python parser to generate a concrete syntax tree. It generates an abstract syntax tree from the concrete tree.</p> <p id="index-0">The <code>transformer</code> module was created by Greg Stein and Bill Tutt for an experimental Python-to-C compiler. The current version contains a number of modifications and improvements, but the basic form of the abstract syntax and of the transformer are due to Stein and Tutt.</p>  <h3 id="ast-nodes">3.1. AST Nodes</h3> <p id="module-compiler.ast">The <a class="reference internal" href="#module-compiler.ast" title="compiler.ast"><code>compiler.ast</code></a> module is generated from a text file that describes each node type and its elements. Each node type is represented as a class that inherits from the abstract base class <a class="reference internal" href="#compiler.ast.Node" title="compiler.ast.Node"><code>compiler.ast.Node</code></a> and defines a set of named attributes for child nodes.</p> <dl class="class"> <dt id="compiler.ast.Node">
<code>class compiler.ast.Node</code> </dt> <dd>
<p>The <a class="reference internal" href="#compiler.ast.Node" title="compiler.ast.Node"><code>Node</code></a> instances are created automatically by the parser generator. The recommended interface for specific <a class="reference internal" href="#compiler.ast.Node" title="compiler.ast.Node"><code>Node</code></a> instances is to use the public attributes to access child nodes. A public attribute may be bound to a single node or to a sequence of nodes, depending on the <a class="reference internal" href="#compiler.ast.Node" title="compiler.ast.Node"><code>Node</code></a> type. For example, the <code>bases</code> attribute of the <code>Class</code> node, is bound to a list of base class nodes, and the <code>doc</code> attribute is bound to a single node.</p> <p>Each <a class="reference internal" href="#compiler.ast.Node" title="compiler.ast.Node"><code>Node</code></a> instance has a <code>lineno</code> attribute which may be <code>None</code>. XXX Not sure what the rules are for which nodes will have a useful lineno.</p> <p>All <a class="reference internal" href="#compiler.ast.Node" title="compiler.ast.Node"><code>Node</code></a> objects offer the following methods:</p> <dl class="method"> <dt id="compiler.ast.Node.getChildren">
<code>getChildren()</code> </dt> <dd>
<p>Returns a flattened list of the child nodes and objects in the order they occur. Specifically, the order of the nodes is the order in which they appear in the Python grammar. Not all of the children are <a class="reference internal" href="#compiler.ast.Node" title="compiler.ast.Node"><code>Node</code></a> instances. The names of functions and classes, for example, are plain strings.</p> </dd>
</dl> <dl class="method"> <dt id="compiler.ast.Node.getChildNodes">
<code>getChildNodes()</code> </dt> <dd>
<p>Returns a flattened list of the child nodes in the order they occur. This method is like <a class="reference internal" href="#compiler.ast.Node.getChildren" title="compiler.ast.Node.getChildren"><code>getChildren()</code></a>, except that it only returns those children that are <a class="reference internal" href="#compiler.ast.Node" title="compiler.ast.Node"><code>Node</code></a> instances.</p> </dd>
</dl> </dd>
</dl> <p>Two examples illustrate the general structure of <a class="reference internal" href="#compiler.ast.Node" title="compiler.ast.Node"><code>Node</code></a> classes. The <a class="reference internal" href="https://docs.python.org/2.7/reference/compound_stmts.html#while" target="_blank"><code>while</code></a> statement is defined by the following grammar production:</p> <pre data-language="python">while_stmt:     "while" expression ":" suite
               ["else" ":" suite]
</pre> <p>The <code>While</code> node has three attributes: <a class="reference internal" href="../test/#module-test" title="test: Regression tests package containing the testing suite for Python."><code>test</code></a>, <code>body</code>, and <code>else_</code>. (If the natural name for an attribute is also a Python reserved word, it can’t be used as an attribute name. An underscore is appended to the word to make it a legal identifier, hence <code>else_</code> instead of <a class="reference internal" href="https://docs.python.org/2.7/reference/compound_stmts.html#else" target="_blank"><code>else</code></a>.)</p> <p>The <a class="reference internal" href="https://docs.python.org/2.7/reference/compound_stmts.html#if" target="_blank"><code>if</code></a> statement is more complicated because it can include several tests.</p> <pre data-language="python">if_stmt: 'if' test ':' suite ('elif' test ':' suite)* ['else' ':' suite]
</pre> <p>The <code>If</code> node only defines two attributes: <code>tests</code> and <code>else_</code>. The <code>tests</code> attribute is a sequence of test expression, consequent body pairs. There is one pair for each <a class="reference internal" href="https://docs.python.org/2.7/reference/compound_stmts.html#if" target="_blank"><code>if</code></a>/<a class="reference internal" href="https://docs.python.org/2.7/reference/compound_stmts.html#elif" target="_blank"><code>elif</code></a> clause. The first element of the pair is the test expression. The second elements is a <code>Stmt</code> node that contains the code to execute if the test is true.</p> <p>The <code>getChildren()</code> method of <code>If</code> returns a flat list of child nodes. If there are three <a class="reference internal" href="https://docs.python.org/2.7/reference/compound_stmts.html#if" target="_blank"><code>if</code></a>/<a class="reference internal" href="https://docs.python.org/2.7/reference/compound_stmts.html#elif" target="_blank"><code>elif</code></a> clauses and no <a class="reference internal" href="https://docs.python.org/2.7/reference/compound_stmts.html#else" target="_blank"><code>else</code></a> clause, then <code>getChildren()</code> will return a list of six elements: the first test expression, the first <code>Stmt</code>, the second text expression, etc.</p> <p>The following table lists each of the <a class="reference internal" href="#compiler.ast.Node" title="compiler.ast.Node"><code>Node</code></a> subclasses defined in <a class="reference internal" href="#module-compiler.ast" title="compiler.ast"><code>compiler.ast</code></a> and each of the public attributes available on their instances. The values of most of the attributes are themselves <a class="reference internal" href="#compiler.ast.Node" title="compiler.ast.Node"><code>Node</code></a> instances or sequences of instances. When the value is something other than an instance, the type is noted in the comment. The attributes are listed in the order in which they are returned by <code>getChildren()</code> and <code>getChildNodes()</code>.</p> <table class="docutils">  <thead valign="bottom"> <tr class="row-odd">
<th class="head">Node type</th> <th class="head">Attribute</th> <th class="head">Value</th> </tr> </thead>  <tr class="row-even">
<td><code>Add</code></td> <td><code>left</code></td> <td>left operand</td> </tr> <tr class="row-odd">
<td> </td> <td><code>right</code></td> <td>right operand</td> </tr> <tr class="row-even">
<td><code>And</code></td> <td><code>nodes</code></td> <td>list of operands</td> </tr> <tr class="row-odd">
<td><code>AssAttr</code></td> <td> </td> <td><em>attribute as target of assignment</em></td> </tr> <tr class="row-even">
<td> </td> <td><code>expr</code></td> <td>expression on the left-hand side of the dot</td> </tr> <tr class="row-odd">
<td> </td> <td><code>attrname</code></td> <td>the attribute name, a string</td> </tr> <tr class="row-even">
<td> </td> <td><code>flags</code></td> <td>XXX</td> </tr> <tr class="row-odd">
<td><code>AssList</code></td> <td><code>nodes</code></td> <td>list of list elements being assigned to</td> </tr> <tr class="row-even">
<td><code>AssName</code></td> <td><code>name</code></td> <td>name being assigned to</td> </tr> <tr class="row-odd">
<td> </td> <td><code>flags</code></td> <td>XXX</td> </tr> <tr class="row-even">
<td><code>AssTuple</code></td> <td><code>nodes</code></td> <td>list of tuple elements being assigned to</td> </tr> <tr class="row-odd">
<td><code>Assert</code></td> <td><a class="reference internal" href="../test/#module-test" title="test: Regression tests package containing the testing suite for Python."><code>test</code></a></td> <td>the expression to be tested</td> </tr> <tr class="row-even">
<td> </td> <td><code>fail</code></td> <td>the value of the <a class="reference internal" href="../exceptions/#exceptions.AssertionError" title="exceptions.AssertionError"><code>AssertionError</code></a>
</td> </tr> <tr class="row-odd">
<td><code>Assign</code></td> <td><code>nodes</code></td> <td>a list of assignment targets, one per equal sign</td> </tr> <tr class="row-even">
<td> </td> <td><code>expr</code></td> <td>the value being assigned</td> </tr> <tr class="row-odd">
<td><code>AugAssign</code></td> <td><code>node</code></td> <td> </td> </tr> <tr class="row-even">
<td> </td> <td><code>op</code></td> <td> </td> </tr> <tr class="row-odd">
<td> </td> <td><code>expr</code></td> <td> </td> </tr> <tr class="row-even">
<td><code>Backquote</code></td> <td><code>expr</code></td> <td> </td> </tr> <tr class="row-odd">
<td><code>Bitand</code></td> <td><code>nodes</code></td> <td> </td> </tr> <tr class="row-even">
<td><code>Bitor</code></td> <td><code>nodes</code></td> <td> </td> </tr> <tr class="row-odd">
<td><code>Bitxor</code></td> <td><code>nodes</code></td> <td> </td> </tr> <tr class="row-even">
<td><code>Break</code></td> <td> </td> <td> </td> </tr> <tr class="row-odd">
<td><code>CallFunc</code></td> <td><code>node</code></td> <td>expression for the callee</td> </tr> <tr class="row-even">
<td> </td> <td><code>args</code></td> <td>a list of arguments</td> </tr> <tr class="row-odd">
<td> </td> <td><code>star_args</code></td> <td>the extended *-arg value</td> </tr> <tr class="row-even">
<td> </td> <td><code>dstar_args</code></td> <td>the extended **-arg value</td> </tr> <tr class="row-odd">
<td><code>Class</code></td> <td><code>name</code></td> <td>the name of the class, a string</td> </tr> <tr class="row-even">
<td> </td> <td><code>bases</code></td> <td>a list of base classes</td> </tr> <tr class="row-odd">
<td> </td> <td><code>doc</code></td> <td>doc string, a string or <code>None</code>
</td> </tr> <tr class="row-even">
<td> </td> <td><a class="reference internal" href="../code/#module-code" title="code: Facilities to implement read-eval-print loops."><code>code</code></a></td> <td>the body of the class statement</td> </tr> <tr class="row-odd">
<td><code>Compare</code></td> <td><code>expr</code></td> <td> </td> </tr> <tr class="row-even">
<td> </td> <td><code>ops</code></td> <td> </td> </tr> <tr class="row-odd">
<td><code>Const</code></td> <td><code>value</code></td> <td> </td> </tr> <tr class="row-even">
<td><code>Continue</code></td> <td> </td> <td> </td> </tr> <tr class="row-odd">
<td><code>Decorators</code></td> <td><code>nodes</code></td> <td>List of function decorator expressions</td> </tr> <tr class="row-even">
<td><code>Dict</code></td> <td><code>items</code></td> <td> </td> </tr> <tr class="row-odd">
<td><code>Discard</code></td> <td><code>expr</code></td> <td> </td> </tr> <tr class="row-even">
<td><code>Div</code></td> <td><code>left</code></td> <td> </td> </tr> <tr class="row-odd">
<td> </td> <td><code>right</code></td> <td> </td> </tr> <tr class="row-even">
<td><a class="reference internal" href="../constants/#Ellipsis" title="Ellipsis"><code>Ellipsis</code></a></td> <td> </td> <td> </td> </tr> <tr class="row-odd">
<td><code>Expression</code></td> <td><code>node</code></td> <td> </td> </tr> <tr class="row-even">
<td><code>Exec</code></td> <td><code>expr</code></td> <td> </td> </tr> <tr class="row-odd">
<td> </td> <td><a class="reference internal" href="../functions/#locals" title="locals"><code>locals</code></a></td> <td> </td> </tr> <tr class="row-even">
<td> </td> <td><a class="reference internal" href="../functions/#globals" title="globals"><code>globals</code></a></td> <td> </td> </tr> <tr class="row-odd">
<td><code>FloorDiv</code></td> <td><code>left</code></td> <td> </td> </tr> <tr class="row-even">
<td> </td> <td><code>right</code></td> <td> </td> </tr> <tr class="row-odd">
<td><code>For</code></td> <td><code>assign</code></td> <td> </td> </tr> <tr class="row-even">
<td> </td> <td><a class="reference internal" href="../functions/#list" title="list"><code>list</code></a></td> <td> </td> </tr> <tr class="row-odd">
<td> </td> <td><code>body</code></td> <td> </td> </tr> <tr class="row-even">
<td> </td> <td><code>else_</code></td> <td> </td> </tr> <tr class="row-odd">
<td><code>From</code></td> <td><code>modname</code></td> <td> </td> </tr> <tr class="row-even">
<td> </td> <td><code>names</code></td> <td> </td> </tr> <tr class="row-odd">
<td><code>Function</code></td> <td><code>decorators</code></td> <td>
<code>Decorators</code> or <code>None</code>
</td> </tr> <tr class="row-even">
<td> </td> <td><code>name</code></td> <td>name used in def, a string</td> </tr> <tr class="row-odd">
<td> </td> <td><code>argnames</code></td> <td>list of argument names, as strings</td> </tr> <tr class="row-even">
<td> </td> <td><code>defaults</code></td> <td>list of default values</td> </tr> <tr class="row-odd">
<td> </td> <td><code>flags</code></td> <td>xxx</td> </tr> <tr class="row-even">
<td> </td> <td><code>doc</code></td> <td>doc string, a string or <code>None</code>
</td> </tr> <tr class="row-odd">
<td> </td> <td><a class="reference internal" href="../code/#module-code" title="code: Facilities to implement read-eval-print loops."><code>code</code></a></td> <td>the body of the function</td> </tr> <tr class="row-even">
<td><code>GenExpr</code></td> <td><a class="reference internal" href="../code/#module-code" title="code: Facilities to implement read-eval-print loops."><code>code</code></a></td> <td> </td> </tr> <tr class="row-odd">
<td><code>GenExprFor</code></td> <td><code>assign</code></td> <td> </td> </tr> <tr class="row-even">
<td> </td> <td><a class="reference internal" href="../functions/#iter" title="iter"><code>iter</code></a></td> <td> </td> </tr> <tr class="row-odd">
<td> </td> <td><code>ifs</code></td> <td> </td> </tr> <tr class="row-even">
<td><code>GenExprIf</code></td> <td><a class="reference internal" href="../test/#module-test" title="test: Regression tests package containing the testing suite for Python."><code>test</code></a></td> <td> </td> </tr> <tr class="row-odd">
<td><code>GenExprInner</code></td> <td><code>expr</code></td> <td> </td> </tr> <tr class="row-even">
<td> </td> <td><code>quals</code></td> <td> </td> </tr> <tr class="row-odd">
<td><code>Getattr</code></td> <td><code>expr</code></td> <td> </td> </tr> <tr class="row-even">
<td> </td> <td><code>attrname</code></td> <td> </td> </tr> <tr class="row-odd">
<td><code>Global</code></td> <td><code>names</code></td> <td> </td> </tr> <tr class="row-even">
<td><code>If</code></td> <td><code>tests</code></td> <td> </td> </tr> <tr class="row-odd">
<td> </td> <td><code>else_</code></td> <td> </td> </tr> <tr class="row-even">
<td><code>Import</code></td> <td><code>names</code></td> <td> </td> </tr> <tr class="row-odd">
<td><code>Invert</code></td> <td><code>expr</code></td> <td> </td> </tr> <tr class="row-even">
<td><code>Keyword</code></td> <td><code>name</code></td> <td> </td> </tr> <tr class="row-odd">
<td> </td> <td><code>expr</code></td> <td> </td> </tr> <tr class="row-even">
<td><code>Lambda</code></td> <td><code>argnames</code></td> <td> </td> </tr> <tr class="row-odd">
<td> </td> <td><code>defaults</code></td> <td> </td> </tr> <tr class="row-even">
<td> </td> <td><code>flags</code></td> <td> </td> </tr> <tr class="row-odd">
<td> </td> <td><a class="reference internal" href="../code/#module-code" title="code: Facilities to implement read-eval-print loops."><code>code</code></a></td> <td> </td> </tr> <tr class="row-even">
<td><code>LeftShift</code></td> <td><code>left</code></td> <td> </td> </tr> <tr class="row-odd">
<td> </td> <td><code>right</code></td> <td> </td> </tr> <tr class="row-even">
<td><code>List</code></td> <td><code>nodes</code></td> <td> </td> </tr> <tr class="row-odd">
<td><code>ListComp</code></td> <td><code>expr</code></td> <td> </td> </tr> <tr class="row-even">
<td> </td> <td><code>quals</code></td> <td> </td> </tr> <tr class="row-odd">
<td><code>ListCompFor</code></td> <td><code>assign</code></td> <td> </td> </tr> <tr class="row-even">
<td> </td> <td><a class="reference internal" href="../functions/#list" title="list"><code>list</code></a></td> <td> </td> </tr> <tr class="row-odd">
<td> </td> <td><code>ifs</code></td> <td> </td> </tr> <tr class="row-even">
<td><code>ListCompIf</code></td> <td><a class="reference internal" href="../test/#module-test" title="test: Regression tests package containing the testing suite for Python."><code>test</code></a></td> <td> </td> </tr> <tr class="row-odd">
<td><code>Mod</code></td> <td><code>left</code></td> <td> </td> </tr> <tr class="row-even">
<td> </td> <td><code>right</code></td> <td> </td> </tr> <tr class="row-odd">
<td><code>Module</code></td> <td><code>doc</code></td> <td>doc string, a string or <code>None</code>
</td> </tr> <tr class="row-even">
<td> </td> <td><code>node</code></td> <td>body of the module, a <code>Stmt</code>
</td> </tr> <tr class="row-odd">
<td><code>Mul</code></td> <td><code>left</code></td> <td> </td> </tr> <tr class="row-even">
<td> </td> <td><code>right</code></td> <td> </td> </tr> <tr class="row-odd">
<td><code>Name</code></td> <td><code>name</code></td> <td> </td> </tr> <tr class="row-even">
<td><code>Not</code></td> <td><code>expr</code></td> <td> </td> </tr> <tr class="row-odd">
<td><code>Or</code></td> <td><code>nodes</code></td> <td> </td> </tr> <tr class="row-even">
<td><code>Pass</code></td> <td> </td> <td> </td> </tr> <tr class="row-odd">
<td><code>Power</code></td> <td><code>left</code></td> <td> </td> </tr> <tr class="row-even">
<td> </td> <td><code>right</code></td> <td> </td> </tr> <tr class="row-odd">
<td><code>Print</code></td> <td><code>nodes</code></td> <td> </td> </tr> <tr class="row-even">
<td> </td> <td><code>dest</code></td> <td> </td> </tr> <tr class="row-odd">
<td><code>Printnl</code></td> <td><code>nodes</code></td> <td> </td> </tr> <tr class="row-even">
<td> </td> <td><code>dest</code></td> <td> </td> </tr> <tr class="row-odd">
<td><code>Raise</code></td> <td><code>expr1</code></td> <td> </td> </tr> <tr class="row-even">
<td> </td> <td><code>expr2</code></td> <td> </td> </tr> <tr class="row-odd">
<td> </td> <td><code>expr3</code></td> <td> </td> </tr> <tr class="row-even">
<td><code>Return</code></td> <td><code>value</code></td> <td> </td> </tr> <tr class="row-odd">
<td><code>RightShift</code></td> <td><code>left</code></td> <td> </td> </tr> <tr class="row-even">
<td> </td> <td><code>right</code></td> <td> </td> </tr> <tr class="row-odd">
<td><code>Slice</code></td> <td><code>expr</code></td> <td> </td> </tr> <tr class="row-even">
<td> </td> <td><code>flags</code></td> <td> </td> </tr> <tr class="row-odd">
<td> </td> <td><code>lower</code></td> <td> </td> </tr> <tr class="row-even">
<td> </td> <td><code>upper</code></td> <td> </td> </tr> <tr class="row-odd">
<td><code>Sliceobj</code></td> <td><code>nodes</code></td> <td>list of statements</td> </tr> <tr class="row-even">
<td><code>Stmt</code></td> <td><code>nodes</code></td> <td> </td> </tr> <tr class="row-odd">
<td><code>Sub</code></td> <td><code>left</code></td> <td> </td> </tr> <tr class="row-even">
<td> </td> <td><code>right</code></td> <td> </td> </tr> <tr class="row-odd">
<td><code>Subscript</code></td> <td><code>expr</code></td> <td> </td> </tr> <tr class="row-even">
<td> </td> <td><code>flags</code></td> <td> </td> </tr> <tr class="row-odd">
<td> </td> <td><code>subs</code></td> <td> </td> </tr> <tr class="row-even">
<td><code>TryExcept</code></td> <td><code>body</code></td> <td> </td> </tr> <tr class="row-odd">
<td> </td> <td><code>handlers</code></td> <td> </td> </tr> <tr class="row-even">
<td> </td> <td><code>else_</code></td> <td> </td> </tr> <tr class="row-odd">
<td><code>TryFinally</code></td> <td><code>body</code></td> <td> </td> </tr> <tr class="row-even">
<td> </td> <td><code>final</code></td> <td> </td> </tr> <tr class="row-odd">
<td><code>Tuple</code></td> <td><code>nodes</code></td> <td> </td> </tr> <tr class="row-even">
<td><code>UnaryAdd</code></td> <td><code>expr</code></td> <td> </td> </tr> <tr class="row-odd">
<td><code>UnarySub</code></td> <td><code>expr</code></td> <td> </td> </tr> <tr class="row-even">
<td><code>While</code></td> <td><a class="reference internal" href="../test/#module-test" title="test: Regression tests package containing the testing suite for Python."><code>test</code></a></td> <td> </td> </tr> <tr class="row-odd">
<td> </td> <td><code>body</code></td> <td> </td> </tr> <tr class="row-even">
<td> </td> <td><code>else_</code></td> <td> </td> </tr> <tr class="row-odd">
<td><code>With</code></td> <td><code>expr</code></td> <td> </td> </tr> <tr class="row-even">
<td> </td> <td><a class="reference internal" href="../functions/#vars" title="vars"><code>vars</code></a></td> <td> </td> </tr> <tr class="row-odd">
<td> </td> <td><code>body</code></td> <td> </td> </tr> <tr class="row-even">
<td><code>Yield</code></td> <td><code>value</code></td> <td> </td> </tr>  </table>   <h3 id="assignment-nodes">3.2. Assignment nodes</h3> <p>There is a collection of nodes used to represent assignments. Each assignment statement in the source code becomes a single <code>Assign</code> node in the AST. The <code>nodes</code> attribute is a list that contains a node for each assignment target. This is necessary because assignment can be chained, e.g. <code>a = b =
2</code>. Each <a class="reference internal" href="#compiler.ast.Node" title="compiler.ast.Node"><code>Node</code></a> in the list will be one of the following classes: <code>AssAttr</code>, <code>AssList</code>, <code>AssName</code>, or <code>AssTuple</code>.</p> <p>Each target assignment node will describe the kind of object being assigned to: <code>AssName</code> for a simple name, e.g. <code>a = 1</code>. <code>AssAttr</code> for an attribute assigned, e.g. <code>a.x = 1</code>. <code>AssList</code> and <code>AssTuple</code> for list and tuple expansion respectively, e.g. <code>a, b, c = a_tuple</code>.</p> <p>The target assignment nodes also have a <code>flags</code> attribute that indicates whether the node is being used for assignment or in a delete statement. The <code>AssName</code> is also used to represent a delete statement, e.g. <code>del
x</code>.</p> <p>When an expression contains several attribute references, an assignment or delete statement will contain only one <code>AssAttr</code> node – for the final attribute reference. The other attribute references will be represented as <code>Getattr</code> nodes in the <code>expr</code> attribute of the <code>AssAttr</code> instance.</p>   <h3 id="examples">3.3. Examples</h3> <p>This section shows several simple examples of ASTs for Python source code. The examples demonstrate how to use the <code>parse()</code> function, what the repr of an AST looks like, and how to access attributes of an AST node.</p> <p>The first module defines a single function. Assume it is stored in <code>doublelib.py</code>.</p> <pre data-language="python">"""This is an example module.

This is the docstring.
"""

def double(x):
    "Return twice the argument"
    return x * 2
</pre> <p>In the interactive interpreter session below, I have reformatted the long AST reprs for readability. The AST reprs use unqualified class names. If you want to create an instance from a repr, you must import the class names from the <a class="reference internal" href="#module-compiler.ast" title="compiler.ast"><code>compiler.ast</code></a> module.</p> <pre data-language="python">&gt;&gt;&gt; import compiler
&gt;&gt;&gt; mod = compiler.parseFile("doublelib.py")
&gt;&gt;&gt; mod
Module('This is an example module.\n\nThis is the docstring.\n',
       Stmt([Function(None, 'double', ['x'], [], 0,
                      'Return twice the argument',
                      Stmt([Return(Mul((Name('x'), Const(2))))]))]))
&gt;&gt;&gt; from compiler.ast import *
&gt;&gt;&gt; Module('This is an example module.\n\nThis is the docstring.\n',
...    Stmt([Function(None, 'double', ['x'], [], 0,
...                   'Return twice the argument',
...                   Stmt([Return(Mul((Name('x'), Const(2))))]))]))
Module('This is an example module.\n\nThis is the docstring.\n',
       Stmt([Function(None, 'double', ['x'], [], 0,
                      'Return twice the argument',
                      Stmt([Return(Mul((Name('x'), Const(2))))]))]))
&gt;&gt;&gt; mod.doc
'This is an example module.\n\nThis is the docstring.\n'
&gt;&gt;&gt; for node in mod.node.nodes:
...     print node
...
Function(None, 'double', ['x'], [], 0, 'Return twice the argument',
         Stmt([Return(Mul((Name('x'), Const(2))))]))
&gt;&gt;&gt; func = mod.node.nodes[0]
&gt;&gt;&gt; func.code
Stmt([Return(Mul((Name('x'), Const(2))))])
</pre>    <h2 id="using-visitors-to-walk-asts">4. Using Visitors to Walk ASTs</h2> <p id="module-compiler.visitor">The visitor pattern is ... The <a class="reference internal" href="#module-compiler" title="compiler: Python code compiler written in Python. (deprecated)"><code>compiler</code></a> package uses a variant on the visitor pattern that takes advantage of Python’s introspection features to eliminate the need for much of the visitor’s infrastructure.</p> <p>The classes being visited do not need to be programmed to accept visitors. The visitor need only define visit methods for classes it is specifically interested in; a default visit method can handle the rest.</p> <p>XXX The magic <code>visit()</code> method for visitors.</p> <dl class="function"> <dt id="compiler.visitor.walk">
<code>compiler.visitor.walk(tree, visitor[, verbose])</code> </dt> 
</dl> <dl class="class"> <dt id="compiler.visitor.ASTVisitor">
<code>class compiler.visitor.ASTVisitor</code> </dt> <dd>
<p>The <a class="reference internal" href="#compiler.visitor.ASTVisitor" title="compiler.visitor.ASTVisitor"><code>ASTVisitor</code></a> is responsible for walking over the tree in the correct order. A walk begins with a call to <a class="reference internal" href="#compiler.visitor.ASTVisitor.preorder" title="compiler.visitor.ASTVisitor.preorder"><code>preorder()</code></a>. For each node, it checks the <em>visitor</em> argument to <a class="reference internal" href="#compiler.visitor.ASTVisitor.preorder" title="compiler.visitor.ASTVisitor.preorder"><code>preorder()</code></a> for a method named ‘visitNodeType,’ where NodeType is the name of the node’s class, e.g. for a <code>While</code> node a <code>visitWhile()</code> would be called. If the method exists, it is called with the node as its first argument.</p> <p>The visitor method for a particular node type can control how child nodes are visited during the walk. The <a class="reference internal" href="#compiler.visitor.ASTVisitor" title="compiler.visitor.ASTVisitor"><code>ASTVisitor</code></a> modifies the visitor argument by adding a visit method to the visitor; this method can be used to visit a particular child node. If no visitor is found for a particular node type, the <a class="reference internal" href="#compiler.visitor.ASTVisitor.default" title="compiler.visitor.ASTVisitor.default"><code>default()</code></a> method is called.</p> <p><a class="reference internal" href="#compiler.visitor.ASTVisitor" title="compiler.visitor.ASTVisitor"><code>ASTVisitor</code></a> objects have the following methods:</p> <p>XXX describe extra arguments</p> <dl class="method"> <dt id="compiler.visitor.ASTVisitor.default">
<code>default(node[, ...])</code> </dt> 
</dl> <dl class="method"> <dt id="compiler.visitor.ASTVisitor.dispatch">
<code>dispatch(node[, ...])</code> </dt> 
</dl> <dl class="method"> <dt id="compiler.visitor.ASTVisitor.preorder">
<code>preorder(tree, visitor)</code> </dt> 
</dl> </dd>
</dl>   <h2 id="bytecode-generation">5. Bytecode Generation</h2> <p>The code generator is a visitor that emits bytecodes. Each visit method can call the <code>emit()</code> method to emit a new bytecode. The basic code generator is specialized for modules, classes, and functions. An assembler converts that emitted instructions to the low-level bytecode format. It handles things like generation of constant lists of code objects and calculation of jump offsets.</p>
<div class="_attribution">
  <p class="_attribution-p">
    © 2001–2017 Python Software Foundation<br>Licensed under the PSF License.<br>
    <a href="https://docs.python.org/2.7/library/compiler.html" class="_attribution-link" target="_blank">https://docs.python.org/2.7/library/compiler.html</a>
  </p>
</div>

				<script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
<!-- 文档结尾内嵌 -->
<ins class="adsbygoogle"
    style="display:block"
    data-ad-client="ca-pub-2572770204602497"
    data-ad-slot="5446239318"
    data-ad-format="auto"
    data-full-width-responsive="true"></ins>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script>
			</div>
		</div>
	</section>

	</div>
	<svg style="display:none">
		<symbol id="icon-dir"><svg viewBox="0 0 20 20"><path d="M15 10c0 .3-.305.515-.305.515l-8.56 5.303c-.625.41-1.135.106-1.135-.67V4.853c0-.777.51-1.078 1.135-.67l8.56 5.305S15 9.702 15 10z"/></svg></symbol>
	  </svg>
</body>
</html>
