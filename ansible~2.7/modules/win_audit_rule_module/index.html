
<!DOCTYPE HTML>

<html lang="en">

<head>
  <meta charset="utf-8">
  <title>Win_audit_rule - Ansible 2.7 - W3cubDocs</title>
  
  <meta name="description" content=" New in version 2.5. ">
  <meta name="keywords" content="win, audit, rule, -, adds, files, folders, or, registry, keys, ansible, ansible~2.7">
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="mobile-web-app-capable" content="yes">
  
  <link rel="canonical" href="http://docs.w3cub.com/ansible~2.7/modules/win_audit_rule_module/">
  <link href="/favicon.png" rel="icon">
  <link rel="stylesheet" type="text/css" href="/assets/application-6ca5be81b81eb73e654078d9aaa623884afe18900617ed9a60729a4905026f77.css">
  <script type="text/javascript" src="/assets/application-2fa35d54abf92f248ac868261a14d3f99b325c34fcc70df314719245e248d73c.js"></script>
  <script src="/json/ansible~2.7.js"></script>
  
  <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-71174418-1']);
    _gaq.push(['_trackPageview']);

    (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
  </script>
  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
        (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-2572770204602497",
            enable_page_level_ads: true
        });
  </script>
  <script async custom-element="amp-auto-ads"
  src="https://cdn.ampproject.org/v0/amp-auto-ads-0.1.js">
</script>


</head>

<body>
	<div class="_app">
	<header class="_header">
  
  <form class="_search">
    <input type="search" class="_search-input" placeholder="Search&hellip;" autocomplete="off" autocapitalize="off" autocorrect="off" spellcheck="false" maxlength="20">
    <a class="_search-clear"></a>
    <div class="_search-tag"></div>
  </form>
  
  <a class="_home-link" href="/" ></a>
  <a class="_menu-link"></a>
  <h1 class="_logo">
    <a href="/" class="_nav-link" title="API Documentation Browser">W3cubDocs</a>
  </h1>
  
  <span class="_logo-sub-nav">/</span><span class="_logo-sub-nav"><a href="/ansible~2.7/" class="_nav-link" title="" style="margin-left:0;">Ansible 2.7</a></span>
  
  <nav class="_nav">
    <a href="/cheatsheets/" class="_nav-link ">Cheatsheets</a>
    <a href="/about/" class="_nav-link ">About</a>
  </nav>
</header>
	<section class="_sidebar">
		<div class="_list">
			
		</div>
	</section>
	<section class="_container ">
		<div class="_content">
			<div class="_page _sphinx">
				
				
<h1 id="win-audit-rule-module">win_audit_rule - Adds an audit rule to files, folders, or registry keys</h1> <div class="versionadded" id="win-audit-rule-adds-an-audit-rule-to-files-folders-or-registry-keys"> <p><span class="versionmodified">New in version 2.5.</span></p> </div>  <ul class="simple"> <li><a class="reference internal" href="#synopsis" id="id1">Synopsis</a></li> <li><a class="reference internal" href="#parameters" id="id2">Parameters</a></li> <li><a class="reference internal" href="#examples" id="id3">Examples</a></li> <li><a class="reference internal" href="#return-values" id="id4">Return Values</a></li> <li><a class="reference internal" href="#status" id="id5">Status</a></li> <li>
<a class="reference internal" href="#maintenance" id="id6">Maintenance</a><ul> <li><a class="reference internal" href="#author" id="id7">Author</a></li> </ul> </li> </ul>   <h2 id="synopsis">Synopsis</h2> <ul class="simple"> <li>Used to apply audit rules to files, folders or registry keys.</li> <li>Once applied, it will begin recording the user who performed the operation defined into the Security Log in the Event viewer.</li> <li>The behavior is designed to ignore inherited rules since those cannot be adjusted without first disabling the inheritance behavior. It will still print inherited rules in the output though for debugging purposes.</li> </ul>   <h2 id="parameters">Parameters</h2> <table class="documentation-table"> <tr> <th colspan="1">Parameter</th> <th>Choices/Defaults</th> <th width="100%">Comments</th> </tr> <tr> <td colspan="1"> <b>audit_flags</b> <br><div style="font-size: small; color: red">list</div> <br><div style="font-size: small; color: red">required</div> </td> <td> <ul>
<b>Choices:</b> <li>Failure</li> <li>Success</li> </ul> </td> <td> <div>Defines whether to log on failure, success, or both.</div> <div>To log both define as comma separated list "Success, Failure".</div> </td> </tr> <tr> <td colspan="1"> <b>inheritance_flags</b> <br><div style="font-size: small; color: red">list</div> </td> <td> <ul>
<b>Choices:</b> <li>ContainerInherit</li> <li>ObjectInherit</li> </ul> <b>Default:</b><br><div style="color: blue">ContainerInherit,ObjectInherit</div> </td> <td> <div>Defines what objects inside of a folder or registry key will inherit the settings.</div> <div>If you are setting a rule on a file, this value has to be changed to <code>none</code>.</div> <div>For more information on the choices see MSDN PropagationFlags enumeration at <a href="https://msdn.microsoft.com/en-us/library/system.security.accesscontrol.inheritanceflags.aspx" target="_blank">https://msdn.microsoft.com/en-us/library/system.security.accesscontrol.inheritanceflags.aspx</a>.</div> </td> </tr> <tr> <td colspan="1"> <b>path</b> <br><div style="font-size: small; color: red">path</div> <br><div style="font-size: small; color: red">required</div> </td> <td> </td> <td> <div>Path to the file, folder, or registry key.</div> <div>Registry paths should be in Powershell format, beginning with an abbreviation for the root such as, 'hklm:\software'.</div> <div style="font-size: small; color: darkgreen">
<br>aliases: dest, destination</div> </td> </tr> <tr> <td colspan="1"> <b>propagation_flags</b> </td> <td> <ul>
<b>Choices:</b> <li><div style="color: blue">
<b>None</b> ←</div></li> <li>InherityOnly</li> <li>NoPropagateInherit</li> </ul> </td> <td> <div>Propagation flag on the audit rules.</div> <div>This value is ignored when the path type is a file.</div> <div>For more information on the choices see MSDN PropagationFlags enumeration at <a href="https://msdn.microsoft.com/en-us/library/system.security.accesscontrol.propagationflags.aspx" target="_blank">https://msdn.microsoft.com/en-us/library/system.security.accesscontrol.propagationflags.aspx</a>.</div> </td> </tr> <tr> <td colspan="1"> <b>rights</b> <br><div style="font-size: small; color: red">list</div> <br><div style="font-size: small; color: red">required</div> </td> <td> </td> <td> <div>Comma separated list of the rights desired. Only required for adding a rule.</div> <div>If <em>path</em> is a file or directory, rights can be any right under MSDN FileSystemRights <a href="https://msdn.microsoft.com/en-us/library/system.security.accesscontrol.filesystemrights.aspx" target="_blank">https://msdn.microsoft.com/en-us/library/system.security.accesscontrol.filesystemrights.aspx</a>.</div> <div>If <em>path</em> is a registry key, rights can be any right under MSDN RegistryRights <a href="https://msdn.microsoft.com/en-us/library/system.security.accesscontrol.registryrights.aspx" target="_blank">https://msdn.microsoft.com/en-us/library/system.security.accesscontrol.registryrights.aspx</a>.</div> </td> </tr> <tr> <td colspan="1"> <b>state</b> </td> <td> <ul>
<b>Choices:</b> <li>absent</li> <li><div style="color: blue">
<b>present</b> ←</div></li> </ul> </td> <td> <div>Whether the rule should be <code>present</code> or <code>absent</code>.</div> <div>For absent, only <em>path</em>, <em>user</em>, and <em>state</em> are required.</div> <div>Specifying <code>absent</code> will remove all rules matching the defined <em>user</em>.</div> </td> </tr> <tr> <td colspan="1"> <b>user</b> <br><div style="font-size: small; color: red">required</div> </td> <td> </td> <td> <div>The user or group to adjust rules for.</div> </td> </tr> </table> <br>  <h2 id="examples">Examples</h2> <pre data-language="yaml">- name: add filesystem audit rule for a folder
  win_audit_rule:
    path: C:\inetpub\wwwroot\website
    user: BUILTIN\Users
    rights: write,delete,changepermissions
    audit_flags: success,failure
    inheritance_flags: ContainerInherit,ObjectInherit

- name: add filesystem audit rule for a file
  win_audit_rule:
    path: C:\inetpub\wwwroot\website\web.config
    user: BUILTIN\Users
    rights: write,delete,changepermissions
    audit_flags: success,failure
    inheritance_flags: None

- name: add registry audit rule
  win_audit_rule:
    path: HKLM:\software
    user: BUILTIN\Users
    rights: delete
    audit_flags: 'success'

- name: remove filesystem audit rule
  win_audit_rule:
    path: C:\inetpub\wwwroot\website
    user: BUILTIN\Users
    state: absent

- name: remove registry audit rule
  win_audit_rule:
    path: HKLM:\software
    user: BUILTIN\Users
    state: absent
</pre>   <h2 id="return-values">Return Values</h2> <p>Common return values are documented <a class="reference internal" href="../../reference_appendices/common_return_values/#common-return-values"><span class="std std-ref">here</span></a>, the following are the fields unique to this module:</p> <table class="documentation-table"> <tr> <th colspan="1">Key</th> <th>Returned</th> <th width="100%">Description</th> </tr> <tr> <td colspan="1"> <b>current_audit_rules</b> <br><div style="font-size: small; color: red">dictionary</div> </td> <td>always</td> <td> <div>The current rules on the defined <em>path</em>
</div> <div>Will return "No audit rules defined on <em>path</em>"</div> <br> <div style="font-size: smaller"><b>Sample:</b></div> <div style="font-size: smaller; color: blue; word-wrap: break-word; word-break: break-all;">{ "audit_flags": "Success", "user": "Everyone", "inheritance_flags": "False", "is_inherited": "False", "propagation_flags": "None", "rights": "Delete" }</div> </td> </tr> <tr> <td colspan="1"> <b>path_type</b> <br><div style="font-size: small; color: red">string</div> </td> <td>always</td> <td> <div>The type of <em>path</em> being targetted.</div> <div>Will be one of file, directory, registry.</div> <br> </td> </tr> </table> <br><br>  <h2 id="status">Status</h2> <p>This module is flagged as <strong>preview</strong> which means that it is not guaranteed to have a backwards compatible interface.</p>   <h2 id="maintenance">Maintenance</h2> <p>This module is flagged as <strong>community</strong> which means that it is maintained by the Ansible Community. See <a class="reference internal" href="../../user_guide/modules_support/#modules-support"><span class="std std-ref">Module Maintenance &amp; Support</span></a> for more info.</p> <p>For a list of other modules that are also maintained by the Ansible Community, see <a class="reference internal" href="../community_maintained/#community-supported"><span class="std std-ref">here</span></a>.</p>  <h3 id="author">Author</h3> <ul class="simple"> <li>Noah Sparks (@nwsparks)</li> </ul> <div class="admonition hint"> <p class="first admonition-title">Hint</p> <p class="last">If you notice any issues in this documentation you can <a class="reference external" href="https://github.com/ansible/ansible/edit/devel/lib/ansible/modules/windows/win_audit_rule.py?description=%3C!---%20Your%20description%20here%20--%3E%0A%0A%2Blabel:%20docsite_pr" target="_blank">edit this document</a> to improve it.</p> </div>
<div class="_attribution">
  <p class="_attribution-p">
    © 2012–2018 Michael DeHaan<br>© 2018 Red Hat, Inc.<br>Licensed under the GNU General Public License version 3.<br>
    <a href="https://docs.ansible.com/ansible/2.7/modules/win_audit_rule_module.html" class="_attribution-link" target="_blank">https://docs.ansible.com/ansible/2.7/modules/win_audit_rule_module.html</a>
  </p>
</div>

				<amp-auto-ads type="adsense"
              data-ad-client="ca-pub-2572770204602497">
</amp-auto-ads>
			</div>
		</div>
	</section>

	</div>
	<svg style="display:none">
		<symbol id="icon-dir"><svg viewBox="0 0 20 20"><path d="M15 10c0 .3-.305.515-.305.515l-8.56 5.303c-.625.41-1.135.106-1.135-.67V4.853c0-.777.51-1.078 1.135-.67l8.56 5.305S15 9.702 15 10z"/></svg></symbol>
	  </svg>
</body>
</html>
