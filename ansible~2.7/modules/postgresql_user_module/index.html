
<!DOCTYPE HTML>

<html lang="en">

<head>
  <meta charset="utf-8">
  <title>Postgresql_user - Ansible 2.7 - W3cubDocs</title>
  
  <meta name="description" content=" The below requirements are needed on the host that executes this module. ">
  <meta name="keywords" content="postgresql, user, -, adds, or, removes, users, roles, from, database, ansible, ansible~2.7">
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="mobile-web-app-capable" content="yes">
  
  <link rel="canonical" href="http://docs.w3cub.com/ansible~2.7/modules/postgresql_user_module/">
  <link href="/favicon.png" rel="icon">
  <link rel="stylesheet" type="text/css" href="/assets/application-6ca5be81b81eb73e654078d9aaa623884afe18900617ed9a60729a4905026f77.css">
  <script type="text/javascript" src="/assets/application-2fa35d54abf92f248ac868261a14d3f99b325c34fcc70df314719245e248d73c.js"></script>
  <script src="/json/ansible~2.7.js"></script>
  
  <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-71174418-1']);
    _gaq.push(['_trackPageview']);

    (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
  </script>
  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
        (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-2572770204602497",
            enable_page_level_ads: true
        });
  </script>
  <script async custom-element="amp-auto-ads"
  src="https://cdn.ampproject.org/v0/amp-auto-ads-0.1.js">
</script>


</head>

<body>
	<div class="_app">
	<header class="_header">
  
  <form class="_search">
    <input type="search" class="_search-input" placeholder="Search&hellip;" autocomplete="off" autocapitalize="off" autocorrect="off" spellcheck="false" maxlength="20">
    <a class="_search-clear"></a>
    <div class="_search-tag"></div>
  </form>
  
  <a class="_home-link" href="/" ></a>
  <a class="_menu-link"></a>
  <h1 class="_logo">
    <a href="/" class="_nav-link" title="API Documentation Browser">W3cubDocs</a>
  </h1>
  
  <span class="_logo-sub-nav">/</span><span class="_logo-sub-nav"><a href="/ansible~2.7/" class="_nav-link" title="" style="margin-left:0;">Ansible 2.7</a></span>
  
  <nav class="_nav">
    <a href="/cheatsheets/" class="_nav-link ">Cheatsheets</a>
    <a href="/about/" class="_nav-link ">About</a>
  </nav>
</header>
	<section class="_sidebar">
		<div class="_list">
			
		</div>
	</section>
	<section class="_container ">
		<div class="_content">
			<div class="_page _sphinx">
				
				
<h1 id="postgresql-user-module">postgresql_user - Adds or removes a users (roles) from a PostgreSQL database.</h1>  <ul class="simple" id="postgresql-user-adds-or-removes-a-users-roles-from-a-postgresql-database"> <li>
<a class="reference internal" href="#synopsis" id="id1">Synopsis</a><ul> <li><a class="reference internal" href="#requirements" id="id2">Requirements</a></li> </ul> </li> <li><a class="reference internal" href="#parameters" id="id3">Parameters</a></li> <li><a class="reference internal" href="#notes" id="id4">Notes</a></li> <li><a class="reference internal" href="#examples" id="id5">Examples</a></li> <li><a class="reference internal" href="#status" id="id6">Status</a></li> <li>
<a class="reference internal" href="#maintenance" id="id7">Maintenance</a><ul> <li><a class="reference internal" href="#author" id="id8">Author</a></li> </ul> </li> </ul>   <h2 id="synopsis">Synopsis</h2> <ul class="simple"> <li>Add or remove PostgreSQL users (roles) from a remote host and, optionally, grant the users access to an existing database or tables.</li> <li>The fundamental function of the module is to create, or delete, roles from a PostgreSQL cluster. Privilege assignment, or removal, is an optional step, which works on one database at a time. This allows for the module to be called several times in the same module to modify the permissions on different databases, or to grant permissions to already existing users.</li> <li>A user cannot be removed until all the privileges have been stripped from the user. In such situation, if the module tries to remove the user it will fail. To avoid this from happening the fail_on_user option signals the module to try to remove the user, but if not possible keep going; the module will report if changes happened and separately if the user was removed or not.</li> </ul>  <h3 id="requirements">Requirements</h3> <p>The below requirements are needed on the host that executes this module.</p> <ul class="simple"> <li>psycopg2</li> </ul>    <h2 id="parameters">Parameters</h2> <table class="documentation-table"> <tr> <th colspan="1">Parameter</th> <th>Choices/Defaults</th> <th width="100%">Comments</th> </tr> <tr> <td colspan="1"> <b>conn_limit</b> <br><div style="font-size: small; color: darkgreen">(added in 2.4)</div> </td> <td> </td> <td> <div>Specifies the user connection limit.</div> </td> </tr> <tr> <td colspan="1"> <b>db</b> </td> <td> </td> <td> <div>Name of database where permissions will be granted.</div> </td> </tr> <tr> <td colspan="1"> <b>encrypted</b> <br><div style="font-size: small; color: red">bool</div> <br><div style="font-size: small; color: darkgreen">(added in 1.4)</div> </td> <td> <ul>
<b>Choices:</b> <li>no</li> <li><div style="color: blue">
<b>yes</b> ←</div></li> </ul> </td> <td> <div>Whether the password is stored hashed in the database. Passwords can be passed already hashed or unhashed, and postgresql ensures the stored password is hashed when <code>encrypted</code> is set.</div> <div>Note: Postgresql 10 and newer doesn't support unhashed passwords.</div> <div>Previous to Ansible 2.6, this was <code>no</code> by default.</div> </td> </tr> <tr> <td colspan="1"> <b>expires</b> <br><div style="font-size: small; color: darkgreen">(added in 1.4)</div> </td> <td> </td> <td> <div>The date at which the user's password is to expire.</div> <div>If set to <code>'infinity'</code>, user's password never expire.</div> <div>Note that this value should be a valid SQL date and time type.</div> </td> </tr> <tr> <td colspan="1"> <b>fail_on_user</b> <br><div style="font-size: small; color: red">bool</div> </td> <td> <ul>
<b>Choices:</b> <li>no</li> <li><div style="color: blue">
<b>yes</b> ←</div></li> </ul> </td> <td> <div>If <code>yes</code>, fail when user can't be removed. Otherwise just log and continue.</div> </td> </tr> <tr> <td colspan="1"> <b>login_host</b> </td> <td> <b>Default:</b><br><div style="color: blue">localhost</div> </td> <td> <div>Host running PostgreSQL.</div> </td> </tr> <tr> <td colspan="1"> <b>login_password</b> </td> <td> </td> <td> <div>Password used to authenticate with PostgreSQL.</div> </td> </tr> <tr> <td colspan="1"> <b>login_unix_socket</b> </td> <td> </td> <td> <div>Path to a Unix domain socket for local connections.</div> </td> </tr> <tr> <td colspan="1"> <b>login_user</b> </td> <td> <b>Default:</b><br><div style="color: blue">postgres</div> </td> <td> <div>User (role) used to authenticate with PostgreSQL.</div> </td> </tr> <tr> <td colspan="1"> <b>name</b> <br><div style="font-size: small; color: red">required</div> </td> <td> </td> <td> <div>Name of the user (role) to add or remove.</div> </td> </tr> <tr> <td colspan="1"> <b>no_password_changes</b> <br><div style="font-size: small; color: red">bool</div> <br><div style="font-size: small; color: darkgreen">(added in 2.0)</div> </td> <td> <ul>
<b>Choices:</b> <li><div style="color: blue">
<b>no</b> ←</div></li> <li>yes</li> </ul> </td> <td> <div>If <code>yes</code>, don't inspect database for password changes. Effective when <code>pg_authid</code> is not accessible (such as AWS RDS). Otherwise, make password changes as necessary.</div> </td> </tr> <tr> <td colspan="1"> <b>password</b> </td> <td> </td> <td> <div>Set the user's password, before 1.4 this was required.</div> <div>Password can be passed unhashed or hashed (MD5-hashed).</div> <div>Unhashed password will automatically be hashed when saved into the database if <code>encrypted</code> parameter is set, otherwise it will be save in plain text format.</div> <div>When passing a hashed password it must be generated with the format <code>'str["md5"] + md5[ password + username ]'</code>, resulting in a total of 35 characters. An easy way to do this is <code>echo "md5$(echo -n 'verysecretpasswordJOE' | md5sum</code>").</div> <div>Note that if the provided password string is already in MD5-hashed format, then it is used as-is, regardless of <code>encrypted</code> parameter.</div> </td> </tr> <tr> <td colspan="1"> <b>port</b> </td> <td> <b>Default:</b><br><div style="color: blue">5432</div> </td> <td> <div>Database port to connect to.</div> </td> </tr> <tr> <td colspan="1"> <b>priv</b> </td> <td> </td> <td> <div>PostgreSQL privileges string in the format: <code>table:priv1,priv2</code>.</div> </td> </tr> <tr> <td colspan="1"> <b>role_attr_flags</b> </td> <td> <ul>
<b>Choices:</b> <li>[NO]SUPERUSER</li> <li>[NO]CREATEROLE</li> <li>[NO]CREATEDB</li> <li>[NO]INHERIT</li> <li>[NO]LOGIN</li> <li>[NO]REPLICATION</li> <li>[NO]BYPASSRLS</li> </ul> </td> <td> <div>PostgreSQL role attributes string in the format: CREATEDB,CREATEROLE,SUPERUSER.</div> <div>Note that '[NO]CREATEUSER' is deprecated.</div> </td> </tr> <tr> <td colspan="1"> <b>ssl_mode</b> <br><div style="font-size: small; color: darkgreen">(added in 2.3)</div> </td> <td> <ul>
<b>Choices:</b> <li>disable</li> <li>allow</li> <li><div style="color: blue">
<b>prefer</b> ←</div></li> <li>require</li> <li>verify-ca</li> <li>verify-full</li> </ul> </td> <td> <div>Determines whether or with what priority a secure SSL TCP/IP connection will be negotiated with the server.</div> <div>See <a href="https://www.postgresql.org/docs/current/static/libpq-ssl.html" target="_blank">https://www.postgresql.org/docs/current/static/libpq-ssl.html</a> for more information on the modes.</div> <div>Default of <code>prefer</code> matches libpq default.</div> </td> </tr> <tr> <td colspan="1"> <b>ssl_rootcert</b> <br><div style="font-size: small; color: darkgreen">(added in 2.3)</div> </td> <td> </td> <td> <div>Specifies the name of a file containing SSL certificate authority (CA) certificate(s). If the file exists, the server's certificate will be verified to be signed by one of these authorities.</div> </td> </tr> <tr> <td colspan="1"> <b>state</b> </td> <td> <ul>
<b>Choices:</b> <li><div style="color: blue">
<b>present</b> ←</div></li> <li>absent</li> </ul> </td> <td> <div>The user (role) state.</div> </td> </tr> </table> <br>  <h2 id="notes">Notes</h2> <div class="admonition note"> <p class="first admonition-title">Note</p> <ul class="last simple"> <li>The default authentication assumes that you are either logging in as or sudo’ing to the postgres account on the host.</li> <li>This module uses psycopg2, a Python PostgreSQL database adapter. You must ensure that psycopg2 is installed on the host before using this module. If the remote host is the PostgreSQL server (which is the default case), then PostgreSQL must also be installed on the remote host. For Ubuntu-based systems, install the postgresql, libpq-dev, and python-psycopg2 packages on the remote host before using this module.</li> <li>If you specify PUBLIC as the user, then the privilege changes will apply to all users. You may not specify password or role_attr_flags when the PUBLIC user is specified.</li> <li>The ssl_rootcert parameter requires at least Postgres version 8.4 and <em>psycopg2</em> version 2.4.3.</li> </ul> </div>   <h2 id="examples">Examples</h2> <pre data-language="yaml"># Create django user and grant access to database and products table
- postgresql_user:
    db: acme
    name: django
    password: ceec4eif7ya
    priv: "CONNECT/products:ALL"
    expires: "Jan 31 2020"

# Create rails user, set its password (MD5-hashed) and grant privilege to create other
# databases and demote rails from super user status
- postgresql_user:
    name: rails
    password: md59543f1d82624df2b31672ec0f7050460
    role_attr_flags: CREATEDB,NOSUPERUSER

# Remove test user privileges from acme
- postgresql_user:
    db: acme
    name: test
    priv: "ALL/products:ALL"
    state: absent
    fail_on_user: no

# Remove test user from test database and the cluster
- postgresql_user:
    db: test
    name: test
    priv: ALL
    state: absent

# Set user's password with no expire date
- postgresql_user:
    db: acme
    name: django
    password: mysupersecretword
    priv: "CONNECT/products:ALL"
    expires: infinity

# Example privileges string format
# INSERT,UPDATE/table:SELECT/anothertable:ALL

# Remove an existing user's password
- postgresql_user:
    db: test
    user: test
    password: ""
</pre>   <h2 id="status">Status</h2> <p>This module is flagged as <strong>stableinterface</strong> which means that the maintainers for this module guarantee that no backward incompatible interface changes will be made.</p>   <h2 id="maintenance">Maintenance</h2> <p>This module is flagged as <strong>community</strong> which means that it is maintained by the Ansible Community. See <a class="reference internal" href="../../user_guide/modules_support/#modules-support"><span class="std std-ref">Module Maintenance &amp; Support</span></a> for more info.</p> <p>For a list of other modules that are also maintained by the Ansible Community, see <a class="reference internal" href="../community_maintained/#community-supported"><span class="std std-ref">here</span></a>.</p>  <h3 id="author">Author</h3> <ul class="simple"> <li>Ansible Core Team</li> </ul> <div class="admonition hint"> <p class="first admonition-title">Hint</p> <p class="last">If you notice any issues in this documentation you can <a class="reference external" href="https://github.com/ansible/ansible/edit/devel/lib/ansible/modules/database/postgresql/postgresql_user.py?description=%3C!---%20Your%20description%20here%20--%3E%0A%0A%2Blabel:%20docsite_pr" target="_blank">edit this document</a> to improve it.</p> </div>
<div class="_attribution">
  <p class="_attribution-p">
    © 2012–2018 Michael DeHaan<br>© 2018 Red Hat, Inc.<br>Licensed under the GNU General Public License version 3.<br>
    <a href="https://docs.ansible.com/ansible/2.7/modules/postgresql_user_module.html" class="_attribution-link" target="_blank">https://docs.ansible.com/ansible/2.7/modules/postgresql_user_module.html</a>
  </p>
</div>

				<amp-auto-ads type="adsense"
              data-ad-client="ca-pub-2572770204602497">
</amp-auto-ads>
			</div>
		</div>
	</section>

	</div>
	<svg style="display:none">
		<symbol id="icon-dir"><svg viewBox="0 0 20 20"><path d="M15 10c0 .3-.305.515-.305.515l-8.56 5.303c-.625.41-1.135.106-1.135-.67V4.853c0-.777.51-1.078 1.135-.67l8.56 5.305S15 9.702 15 10z"/></svg></symbol>
	  </svg>
</body>
</html>
