
<!DOCTYPE HTML>

<html lang="en">

<head>
  <meta charset="utf-8">
  <title>Shell - Ansible 2.7 - W3cubDocs</title>
  
  <meta name="description" content=" Note ">
  <meta name="keywords" content="shell, -, execute, commands, nodes, ansible, ansible~2.7">
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="mobile-web-app-capable" content="yes">
  
  <link rel="canonical" href="http://docs.w3cub.com/ansible~2.7/modules/shell_module/">
  <link href="/favicon.png" rel="icon">
  <link rel="stylesheet" type="text/css" href="/assets/application-6ca5be81b81eb73e654078d9aaa623884afe18900617ed9a60729a4905026f77.css">
  <script type="text/javascript" src="/assets/application-2fa35d54abf92f248ac868261a14d3f99b325c34fcc70df314719245e248d73c.js"></script>
  <script src="/json/ansible~2.7.js"></script>
  
  <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-71174418-1']);
    _gaq.push(['_trackPageview']);

    (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
  </script>
  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
        (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-2572770204602497",
            enable_page_level_ads: true
        });
  </script>
  <script async custom-element="amp-auto-ads"
  src="https://cdn.ampproject.org/v0/amp-auto-ads-0.1.js">
</script>


</head>

<body>
	<div class="_app">
	<header class="_header">
  
  <form class="_search">
    <input type="search" class="_search-input" placeholder="Search&hellip;" autocomplete="off" autocapitalize="off" autocorrect="off" spellcheck="false" maxlength="20">
    <a class="_search-clear"></a>
    <div class="_search-tag"></div>
  </form>
  
  <a class="_home-link" href="/" ></a>
  <a class="_menu-link"></a>
  <h1 class="_logo">
    <a href="/" class="_nav-link" title="API Documentation Browser">W3cubDocs</a>
  </h1>
  
  <span class="_logo-sub-nav">/</span><span class="_logo-sub-nav"><a href="/ansible~2.7/" class="_nav-link" title="" style="margin-left:0;">Ansible 2.7</a></span>
  
  <nav class="_nav">
    <a href="/cheatsheets/" class="_nav-link ">Cheatsheets</a>
    <a href="/about/" class="_nav-link ">About</a>
  </nav>
</header>
	<section class="_sidebar">
		<div class="_list">
			
		</div>
	</section>
	<section class="_container ">
		<div class="_content">
			<div class="_page _sphinx">
				
				
<h1 id="shell-module">shell - Execute commands in nodes.</h1>  <ul class="simple" id="shell-execute-commands-in-nodes"> <li><a class="reference internal" href="#synopsis" id="id1">Synopsis</a></li> <li><a class="reference internal" href="#parameters" id="id2">Parameters</a></li> <li><a class="reference internal" href="#notes" id="id3">Notes</a></li> <li><a class="reference internal" href="#examples" id="id4">Examples</a></li> <li><a class="reference internal" href="#return-values" id="id5">Return Values</a></li> <li><a class="reference internal" href="#status" id="id6">Status</a></li> <li>
<a class="reference internal" href="#maintenance" id="id7">Maintenance</a><ul> <li><a class="reference internal" href="#support" id="id8">Support</a></li> <li><a class="reference internal" href="#author" id="id9">Author</a></li> </ul> </li> </ul>   <h2 id="synopsis">Synopsis</h2> <ul class="simple"> <li>The <code>shell</code> module takes the command name followed by a list of space-delimited arguments. It is almost exactly like the <a class="reference internal" href="../command_module/#command-module"><span class="std std-ref">command</span></a> module but runs the command through a shell (<code>/bin/sh</code>) on the remote node.</li> <li>For Windows targets, use the <a class="reference internal" href="../win_shell_module/#win-shell-module"><span class="std std-ref">win_shell</span></a> module instead.</li> </ul>   <h2 id="parameters">Parameters</h2> <table class="documentation-table"> <tr> <th colspan="1">Parameter</th> <th>Choices/Defaults</th> <th width="100%">Comments</th> </tr> <tr> <td colspan="1"> <b>chdir</b> </td> <td> </td> <td> <div>cd into this directory before running the command</div> </td> </tr> <tr> <td colspan="1"> <b>creates</b> </td> <td> </td> <td> <div>a filename, when it already exists, this step will <b>not</b> be run.</div> </td> </tr> <tr> <td colspan="1"> <b>executable</b> </td> <td> </td> <td> <div>change the shell used to execute the command. Should be an absolute path to the executable.</div> </td> </tr> <tr> <td colspan="1"> <b>free_form</b> <br><div style="font-size: small; color: red">required</div> </td> <td> </td> <td> <div>The shell module takes a free form command to run, as a string. There's not an actual option named "free form". See the examples!</div> </td> </tr> <tr> <td colspan="1"> <b>removes</b> </td> <td> </td> <td> <div>a filename, when it does not exist, this step will <b>not</b> be run.</div> </td> </tr> <tr> <td colspan="1"> <b>stdin</b> <br><div style="font-size: small; color: darkgreen">(added in 2.4)</div> </td> <td> </td> <td> <div>Set the stdin of the command directly to the specified value.</div> </td> </tr> <tr> <td colspan="1"> <b>warn</b> <br><div style="font-size: small; color: red">bool</div> <br><div style="font-size: small; color: darkgreen">(added in 1.8)</div> </td> <td> <ul>
<b>Choices:</b> <li>no</li> <li><div style="color: blue">
<b>yes</b> ←</div></li> </ul> </td> <td> <div>if command warnings are on in ansible.cfg, do not warn about this particular line if set to no/false.</div> </td> </tr> </table> <br>  <h2 id="notes">Notes</h2> <div class="admonition note"> <p class="first admonition-title">Note</p> <ul class="last simple"> <li>If you want to execute a command securely and predictably, it may be better to use the <a class="reference internal" href="../command_module/#command-module"><span class="std std-ref">command</span></a> module instead. Best practices when writing playbooks will follow the trend of using <a class="reference internal" href="../command_module/#command-module"><span class="std std-ref">command</span></a> unless the <code>shell</code> module is explicitly required. When running ad-hoc commands, use your best judgement.</li> <li>Check mode is supported when passing <code>creates</code> or <code>removes</code>. If running in check mode and either of these are specified, the module will check for the existence of the file and report the correct changed status. If these are not supplied, the task will be skipped.</li> <li>To sanitize any variables passed to the shell module, you should use “{{ var | quote }}” instead of just “{{ var }}” to make sure they don’t include evil things like semicolons.</li> <li>For Windows targets, use the <a class="reference internal" href="../win_shell_module/#win-shell-module"><span class="std std-ref">win_shell</span></a> module instead.</li> <li>Rather than using here documents to create multi-line scripts inside playbooks, use the <a class="reference internal" href="../script_module/#script-module"><span class="std std-ref">script</span></a> module instead.</li> </ul> </div>   <h2 id="examples">Examples</h2> <pre data-language="yaml">- name: Execute the command in remote shell; stdout goes to the specified file on the remote.
  shell: somescript.sh &gt;&gt; somelog.txt

- name: Change the working directory to somedir/ before executing the command.
  shell: somescript.sh &gt;&gt; somelog.txt
  args:
    chdir: somedir/

# You can also use the 'args' form to provide the options.
- name: This command will change the working directory to somedir/ and will only run when somedir/somelog.txt doesn't exist.
  shell: somescript.sh &gt;&gt; somelog.txt
  args:
    chdir: somedir/
    creates: somelog.txt

- name: Run a command that uses non-posix shell-isms (in this example /bin/sh doesn't handle redirection and wildcards together but bash does)
  shell: cat &lt; /tmp/*txt
  args:
    executable: /bin/bash

- name: Run a command using a templated variable (always use quote filter to avoid injection)
  shell: cat {{ myfile|quote }}

# You can use shell to run other executables to perform actions inline
- name: Run expect to wait for a successful PXE boot via out-of-band CIMC
  shell: |
    set timeout 300
    spawn ssh admin@{{ cimc_host }}

    expect "password:"
    send "{{ cimc_password }}\n"

    expect "\n{{ cimc_name }}"
    send "connect host\n"

    expect "pxeboot.n12"
    send "\n"

    exit 0
  args:
    executable: /usr/bin/expect
  delegate_to: localhost

# Disabling warnings
- name: Using curl to connect to a host via SOCKS proxy (unsupported in uri). Ordinarily this would throw a warning.
  shell: curl --socks5 localhost:9000 http://www.ansible.com
  args:
    warn: False
</pre>   <h2 id="return-values">Return Values</h2> <p>Common return values are documented <a class="reference internal" href="../../reference_appendices/common_return_values/#common-return-values"><span class="std std-ref">here</span></a>, the following are the fields unique to this module:</p> <table class="documentation-table"> <tr> <th colspan="1">Key</th> <th>Returned</th> <th width="100%">Description</th> </tr> <tr> <td colspan="1"> <b>cmd</b> <br><div style="font-size: small; color: red">string</div> </td> <td>always</td> <td> <div>The command executed by the task</div> <br> <div style="font-size: smaller"><b>Sample:</b></div> <div style="font-size: smaller; color: blue; word-wrap: break-word; word-break: break-all;">rabbitmqctl join_cluster rabbit@master</div> </td> </tr> <tr> <td colspan="1"> <b>delta</b> <br><div style="font-size: small; color: red">string</div> </td> <td>always</td> <td> <div>The command execution delta time</div> <br> <div style="font-size: smaller"><b>Sample:</b></div> <div style="font-size: smaller; color: blue; word-wrap: break-word; word-break: break-all;">0:00:00.325771</div> </td> </tr> <tr> <td colspan="1"> <b>end</b> <br><div style="font-size: small; color: red">string</div> </td> <td>always</td> <td> <div>The command execution end time</div> <br> <div style="font-size: smaller"><b>Sample:</b></div> <div style="font-size: smaller; color: blue; word-wrap: break-word; word-break: break-all;">2016-02-25 09:18:26.755339</div> </td> </tr> <tr> <td colspan="1"> <b>msg</b> <br><div style="font-size: small; color: red">boolean</div> </td> <td>always</td> <td> <div>changed</div> <br> <div style="font-size: smaller"><b>Sample:</b></div> <div style="font-size: smaller; color: blue; word-wrap: break-word; word-break: break-all;">True</div> </td> </tr> <tr> <td colspan="1"> <b>rc</b> <br><div style="font-size: small; color: red">int</div> </td> <td>always</td> <td> <div>The command return code (0 means success)</div> <br> </td> </tr> <tr> <td colspan="1"> <b>start</b> <br><div style="font-size: small; color: red">string</div> </td> <td>always</td> <td> <div>The command execution start time</div> <br> <div style="font-size: smaller"><b>Sample:</b></div> <div style="font-size: smaller; color: blue; word-wrap: break-word; word-break: break-all;">2016-02-25 09:18:26.429568</div> </td> </tr> <tr> <td colspan="1"> <b>stderr</b> <br><div style="font-size: small; color: red">string</div> </td> <td>always</td> <td> <div>The command standard error</div> <br> <div style="font-size: smaller"><b>Sample:</b></div> <div style="font-size: smaller; color: blue; word-wrap: break-word; word-break: break-all;">ls: cannot access foo: No such file or directory</div> </td> </tr> <tr> <td colspan="1"> <b>stdout</b> <br><div style="font-size: small; color: red">string</div> </td> <td>always</td> <td> <div>The command standard output</div> <br> <div style="font-size: smaller"><b>Sample:</b></div> <div style="font-size: smaller; color: blue; word-wrap: break-word; word-break: break-all;">Clustering node rabbit@slave1 with rabbit@master ...</div> </td> </tr> <tr> <td colspan="1"> <b>stdout_lines</b> <br><div style="font-size: small; color: red">list</div> </td> <td>always</td> <td> <div>The command standard output split in lines</div> <br> <div style="font-size: smaller"><b>Sample:</b></div> <div style="font-size: smaller; color: blue; word-wrap: break-word; word-break: break-all;">["u'Clustering node rabbit@slave1 with rabbit@master ...'"]</div> </td> </tr> </table> <br><br>  <h2 id="status">Status</h2> <p>This module is flagged as <strong>stableinterface</strong> which means that the maintainers for this module guarantee that no backward incompatible interface changes will be made.</p>   <h2 id="maintenance">Maintenance</h2> <p>This module is flagged as <strong>core</strong> which means that it is maintained by the Ansible Core Team. See <a class="reference internal" href="../../user_guide/modules_support/#modules-support"><span class="std std-ref">Module Maintenance &amp; Support</span></a> for more info.</p> <p>For a list of other modules that are also maintained by the Ansible Core Team, see <a class="reference internal" href="../core_maintained/#core-supported"><span class="std std-ref">here</span></a>.</p>  <h3 id="support">Support</h3> <p>For more information about Red Hat’s support of this module, please refer to this <a class="reference external" href="https://access.redhat.com/articles/rhel-top-support-policies/" target="_blank">Knowledge Base article</a></p>   <h3 id="author">Author</h3> <ul class="simple"> <li>Ansible Core Team</li> <li>Michael DeHaan</li> </ul> <div class="admonition hint"> <p class="first admonition-title">Hint</p> <p class="last">If you notice any issues in this documentation you can <a class="reference external" href="https://github.com/ansible/ansible/edit/devel/lib/ansible/modules/commands/shell.py?description=%3C!---%20Your%20description%20here%20--%3E%0A%0A%2Blabel:%20docsite_pr" target="_blank">edit this document</a> to improve it.</p> </div>
<div class="_attribution">
  <p class="_attribution-p">
    © 2012–2018 Michael DeHaan<br>© 2018 Red Hat, Inc.<br>Licensed under the GNU General Public License version 3.<br>
    <a href="https://docs.ansible.com/ansible/2.7/modules/shell_module.html" class="_attribution-link" target="_blank">https://docs.ansible.com/ansible/2.7/modules/shell_module.html</a>
  </p>
</div>

				<amp-auto-ads type="adsense"
              data-ad-client="ca-pub-2572770204602497">
</amp-auto-ads>
			</div>
		</div>
	</section>

	</div>
	<svg style="display:none">
		<symbol id="icon-dir"><svg viewBox="0 0 20 20"><path d="M15 10c0 .3-.305.515-.305.515l-8.56 5.303c-.625.41-1.135.106-1.135-.67V4.853c0-.777.51-1.078 1.135-.67l8.56 5.305S15 9.702 15 10z"/></svg></symbol>
	  </svg>
</body>
</html>
