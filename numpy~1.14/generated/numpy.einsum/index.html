
<!DOCTYPE HTML>

<html lang="en">

<head>
  <meta charset="utf-8">
  <title>numpy.einsum() - NumPy 1.14 - W3cubDocs</title>
  
  <meta name="description" content=" Evaluates the Einstein summation convention on the operands. ">
  <meta name="keywords" content="numpy, einsum, -, numpy~1.14">
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="mobile-web-app-capable" content="yes">
  
  <link rel="canonical" href="http://docs.w3cub.com/numpy~1.14/generated/numpy.einsum/">
  <link href="/favicon.png" rel="icon">
  <link rel="stylesheet" type="text/css" href="/assets/application-6cc8ff3c95d062e2cd87636799240e79e4553263ad7de9cda9464063203db436.css" integrity="sha256-bMj/PJXQYuLNh2NnmSQOeeRVMmOtfenNqUZAYyA9tDY=" crossorigin="anonymous">
  <script type="text/javascript" integrity="sha256-JOOcjTvTbt5QE9AmOH1rrXz8aKKfHMsOthbsjt9CNfk=" crossorigin="anonymous" src="/assets/application-24e39c8d3bd36ede5013d026387d6bad7cfc68a29f1ccb0eb616ec8edf4235f9.js"></script>
  <script src="/json/numpy~1.14.js"></script>
  
  <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-71174418-1']);
    _gaq.push(['_trackPageview']);

    (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
  </script>


</head>

<body>
	<div class="_app">
	<header class="_header">
  
  <form class="_search">
    <input type="search" class="_search-input" placeholder="Search&hellip;" autocomplete="off" autocapitalize="off" autocorrect="off" spellcheck="false" maxlength="20">
    <a class="_search-clear"></a>
    <div class="_search-tag"></div>
  </form>
  
  <a class="_home-link" href="/" ></a>
  <a class="_menu-link"></a>
  <h1 class="_logo">
    <a href="/" class="_nav-link" title="API Documentation Browser">W3cubDocs</a>
  </h1>
  
  <span class="_logo-sub-nav">/</span><span class="_logo-sub-nav"><a href="/numpy~1.14/" class="_nav-link" title="" style="margin-left:0;">NumPy 1.14</a></span>
  
  <nav class="_nav">
    <a href="/app/" class="_nav-link ">App</a>
    <a href="/about/" class="_nav-link ">About</a>
  </nav>
</header>
	<section class="_sidebar">
		<div class="_list">
			
		</div>
	</section>
	<section class="_container ">
		<div class="_content">
			<div class="_page _sphinx">
				<script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
<!-- 文档开头内嵌 -->
<ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-2572770204602497"
     data-ad-slot="8852552735"
     data-ad-format="auto"
     data-full-width-responsive="true"></ins>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script>
				
<h1 id="numpy-einsum">numpy.einsum</h1> <dl class="function"> <dt id="numpy.einsum">
<code>numpy.einsum(subscripts, *operands, out=None, dtype=None, order='K', casting='safe', optimize=False)</code> <a class="reference external" href="http://github.com/numpy/numpy/blob/v1.14.2/numpy/core/einsumfunc.py#L824-L1158" target="_blank"><span class="viewcode-link">[source]</span></a>
</dt> <dd>
<p>Evaluates the Einstein summation convention on the operands.</p> <p>Using the Einstein summation convention, many common multi-dimensional array operations can be represented in a simple fashion. This function provides a way to compute such summations. The best way to understand this function is to try the examples below, which show how many common NumPy functions can be implemented as calls to <a class="reference internal" href="#numpy.einsum" title="numpy.einsum"><code>einsum</code></a>.</p> <table class="docutils field-list" frame="void" rules="none"> <col class="field-name"> <col class="field-body">  <tr>
<th class="field-name">Parameters:</th>
<td class="field-body">
<p class="first"><strong>subscripts</strong> : str</p>  <p>Specifies the subscripts for summation.</p>  <p><strong>operands</strong> : list of array_like</p>  <p>These are the arrays for the operation.</p>  <p><strong>out</strong> : {ndarray, None}, optional</p>  <p>If provided, the calculation is done into this array.</p>  <p><strong>dtype</strong> : {data-type, None}, optional</p>  <p>If provided, forces the calculation to use the data type specified. Note that you may have to also give a more liberal <code>casting</code> parameter to allow the conversions. Default is None.</p>  <p><strong>order</strong> : {‘C’, ‘F’, ‘A’, ‘K’}, optional</p>  <p>Controls the memory layout of the output. ‘C’ means it should be C contiguous. ‘F’ means it should be Fortran contiguous, ‘A’ means it should be ‘F’ if the inputs are all ‘F’, ‘C’ otherwise. ‘K’ means it should be as close to the layout as the inputs as is possible, including arbitrarily permuted axes. Default is ‘K’.</p>  <p><strong>casting</strong> : {‘no’, ‘equiv’, ‘safe’, ‘same_kind’, ‘unsafe’}, optional</p>  <p>Controls what kind of data casting may occur. Setting this to ‘unsafe’ is not recommended, as it can adversely affect accumulations.</p>  <ul class="simple"> <li>‘no’ means the data types should not be cast at all.</li> <li>‘equiv’ means only byte-order changes are allowed.</li> <li>‘safe’ means only casts which can preserve values are allowed.</li> <li>‘same_kind’ means only safe casts or casts within a kind, like float64 to float32, are allowed.</li> <li>‘unsafe’ means any data conversions may be done.</li> </ul>  <p>Default is ‘safe’.</p>  <p><strong>optimize</strong> : {False, True, ‘greedy’, ‘optimal’}, optional</p>  <p>Controls if intermediate optimization should occur. No optimization will occur if False and True will default to the ‘greedy’ algorithm. Also accepts an explicit contraction list from the <code>np.einsum_path</code> function. See <code>np.einsum_path</code> for more details. Default is False.</p>  </td> </tr> <tr>
<th class="field-name">Returns:</th>
<td class="field-body">
<p class="first"><strong>output</strong> : ndarray</p>  <p>The calculation based on the Einstein summation convention.</p>  </td> </tr>  </table> <div class="admonition seealso"> <p class="first admonition-title">See also</p> <p class="last"><a class="reference internal" href="../numpy.einsum_path/#numpy.einsum_path" title="numpy.einsum_path"><code>einsum_path</code></a>, <a class="reference internal" href="../numpy.dot/#numpy.dot" title="numpy.dot"><code>dot</code></a>, <a class="reference internal" href="../numpy.inner/#numpy.inner" title="numpy.inner"><code>inner</code></a>, <a class="reference internal" href="../numpy.outer/#numpy.outer" title="numpy.outer"><code>outer</code></a>, <a class="reference internal" href="../numpy.tensordot/#numpy.tensordot" title="numpy.tensordot"><code>tensordot</code></a>, <a class="reference internal" href="../numpy.linalg.multi_dot/#numpy.linalg.multi_dot" title="numpy.linalg.multi_dot"><code>linalg.multi_dot</code></a></p> </div> <h4 class="rubric">Notes</h4> <div class="versionadded"> <p><span class="versionmodified">New in version 1.6.0.</span></p> </div> <p>The subscripts string is a comma-separated list of subscript labels, where each label refers to a dimension of the corresponding operand. Repeated subscripts labels in one operand take the diagonal. For example, <code>np.einsum('ii', a)</code> is equivalent to <code>np.trace(a)</code>.</p> <p>Whenever a label is repeated, it is summed, so <code>np.einsum('i,i', a, b)</code> is equivalent to <code>np.inner(a,b)</code>. If a label appears only once, it is not summed, so <code>np.einsum('i', a)</code> produces a view of <code>a</code> with no changes.</p> <p>The order of labels in the output is by default alphabetical. This means that <code>np.einsum('ij', a)</code> doesn’t affect a 2D array, while <code>np.einsum('ji', a)</code> takes its transpose.</p> <p>The output can be controlled by specifying output subscript labels as well. This specifies the label order, and allows summing to be disallowed or forced when desired. The call <code>np.einsum('i-&gt;', a)</code> is like <code>np.sum(a, axis=-1)</code>, and <code>np.einsum('ii-&gt;i', a)</code> is like <code>np.diag(a)</code>. The difference is that <a class="reference internal" href="#numpy.einsum" title="numpy.einsum"><code>einsum</code></a> does not allow broadcasting by default.</p> <p>To enable and control broadcasting, use an ellipsis. Default NumPy-style broadcasting is done by adding an ellipsis to the left of each term, like <code>np.einsum('...ii-&gt;...i', a)</code>. To take the trace along the first and last axes, you can do <code>np.einsum('i...i', a)</code>, or to do a matrix-matrix product with the left-most indices instead of rightmost, you can do <code>np.einsum('ij...,jk...-&gt;ik...', a, b)</code>.</p> <p>When there is only one operand, no axes are summed, and no output parameter is provided, a view into the operand is returned instead of a new array. Thus, taking the diagonal as <code>np.einsum('ii-&gt;i', a)</code> produces a view.</p> <p>An alternative way to provide the subscripts and operands is as <code>einsum(op0, sublist0, op1, sublist1, ..., [sublistout])</code>. The examples below have corresponding <a class="reference internal" href="#numpy.einsum" title="numpy.einsum"><code>einsum</code></a> calls with the two parameter methods.</p> <div class="versionadded"> <p><span class="versionmodified">New in version 1.10.0.</span></p> </div> <p>Views returned from einsum are now writeable whenever the input array is writeable. For example, <code>np.einsum('ijk...-&gt;kji...', a)</code> will now have the same effect as <code>np.swapaxes(a, 0, 2)</code> and <code>np.einsum('ii-&gt;i', a)</code> will return a writeable view of the diagonal of a 2D array.</p> <div class="versionadded"> <p><span class="versionmodified">New in version 1.12.0.</span></p> </div> <p>Added the <code>optimize</code> argument which will optimize the contraction order of an einsum expression. For a contraction with three or more operands this can greatly increase the computational efficiency at the cost of a larger memory footprint during computation.</p> <p>See <code>np.einsum_path</code> for more details.</p> <h4 class="rubric">Examples</h4> <pre data-language="python">&gt;&gt;&gt; a = np.arange(25).reshape(5,5)
&gt;&gt;&gt; b = np.arange(5)
&gt;&gt;&gt; c = np.arange(6).reshape(2,3)
</pre> <pre data-language="python">&gt;&gt;&gt; np.einsum('ii', a)
60
&gt;&gt;&gt; np.einsum(a, [0,0])
60
&gt;&gt;&gt; np.trace(a)
60
</pre> <pre data-language="python">&gt;&gt;&gt; np.einsum('ii-&gt;i', a)
array([ 0,  6, 12, 18, 24])
&gt;&gt;&gt; np.einsum(a, [0,0], [0])
array([ 0,  6, 12, 18, 24])
&gt;&gt;&gt; np.diag(a)
array([ 0,  6, 12, 18, 24])
</pre> <pre data-language="python">&gt;&gt;&gt; np.einsum('ij,j', a, b)
array([ 30,  80, 130, 180, 230])
&gt;&gt;&gt; np.einsum(a, [0,1], b, [1])
array([ 30,  80, 130, 180, 230])
&gt;&gt;&gt; np.dot(a, b)
array([ 30,  80, 130, 180, 230])
&gt;&gt;&gt; np.einsum('...j,j', a, b)
array([ 30,  80, 130, 180, 230])
</pre> <pre data-language="python">&gt;&gt;&gt; np.einsum('ji', c)
array([[0, 3],
       [1, 4],
       [2, 5]])
&gt;&gt;&gt; np.einsum(c, [1,0])
array([[0, 3],
       [1, 4],
       [2, 5]])
&gt;&gt;&gt; c.T
array([[0, 3],
       [1, 4],
       [2, 5]])
</pre> <pre data-language="python">&gt;&gt;&gt; np.einsum('..., ...', 3, c)
array([[ 0,  3,  6],
       [ 9, 12, 15]])
&gt;&gt;&gt; np.einsum(',ij', 3, C)
array([[ 0,  3,  6],
       [ 9, 12, 15]])
&gt;&gt;&gt; np.einsum(3, [Ellipsis], c, [Ellipsis])
array([[ 0,  3,  6],
       [ 9, 12, 15]])
&gt;&gt;&gt; np.multiply(3, c)
array([[ 0,  3,  6],
       [ 9, 12, 15]])
</pre> <pre data-language="python">&gt;&gt;&gt; np.einsum('i,i', b, b)
30
&gt;&gt;&gt; np.einsum(b, [0], b, [0])
30
&gt;&gt;&gt; np.inner(b,b)
30
</pre> <pre data-language="python">&gt;&gt;&gt; np.einsum('i,j', np.arange(2)+1, b)
array([[0, 1, 2, 3, 4],
       [0, 2, 4, 6, 8]])
&gt;&gt;&gt; np.einsum(np.arange(2)+1, [0], b, [1])
array([[0, 1, 2, 3, 4],
       [0, 2, 4, 6, 8]])
&gt;&gt;&gt; np.outer(np.arange(2)+1, b)
array([[0, 1, 2, 3, 4],
       [0, 2, 4, 6, 8]])
</pre> <pre data-language="python">&gt;&gt;&gt; np.einsum('i...-&gt;...', a)
array([50, 55, 60, 65, 70])
&gt;&gt;&gt; np.einsum(a, [0,Ellipsis], [Ellipsis])
array([50, 55, 60, 65, 70])
&gt;&gt;&gt; np.sum(a, axis=0)
array([50, 55, 60, 65, 70])
</pre> <pre data-language="python">&gt;&gt;&gt; a = np.arange(60.).reshape(3,4,5)
&gt;&gt;&gt; b = np.arange(24.).reshape(4,3,2)
&gt;&gt;&gt; np.einsum('ijk,jil-&gt;kl', a, b)
array([[ 4400.,  4730.],
       [ 4532.,  4874.],
       [ 4664.,  5018.],
       [ 4796.,  5162.],
       [ 4928.,  5306.]])
&gt;&gt;&gt; np.einsum(a, [0,1,2], b, [1,0,3], [2,3])
array([[ 4400.,  4730.],
       [ 4532.,  4874.],
       [ 4664.,  5018.],
       [ 4796.,  5162.],
       [ 4928.,  5306.]])
&gt;&gt;&gt; np.tensordot(a,b, axes=([1,0],[0,1]))
array([[ 4400.,  4730.],
       [ 4532.,  4874.],
       [ 4664.,  5018.],
       [ 4796.,  5162.],
       [ 4928.,  5306.]])
</pre> <pre data-language="python">&gt;&gt;&gt; a = np.arange(6).reshape((3,2))
&gt;&gt;&gt; b = np.arange(12).reshape((4,3))
&gt;&gt;&gt; np.einsum('ki,jk-&gt;ij', a, b)
array([[10, 28, 46, 64],
       [13, 40, 67, 94]])
&gt;&gt;&gt; np.einsum('ki,...k-&gt;i...', a, b)
array([[10, 28, 46, 64],
       [13, 40, 67, 94]])
&gt;&gt;&gt; np.einsum('k...,jk', a, b)
array([[10, 28, 46, 64],
       [13, 40, 67, 94]])
</pre> <pre data-language="python">&gt;&gt;&gt; # since version 1.10.0
&gt;&gt;&gt; a = np.zeros((3, 3))
&gt;&gt;&gt; np.einsum('ii-&gt;i', a)[:] = 1
&gt;&gt;&gt; a
array([[ 1.,  0.,  0.],
       [ 0.,  1.,  0.],
       [ 0.,  0.,  1.]])
</pre> </dd>
</dl>
<div class="_attribution">
  <p class="_attribution-p">
    © 2008–2017 NumPy Developers<br>Licensed under the NumPy License.<br>
    <a href="https://docs.scipy.org/doc/numpy-1.14.2/reference/generated/numpy.einsum.html" class="_attribution-link" target="_blank">https://docs.scipy.org/doc/numpy-1.14.2/reference/generated/numpy.einsum.html</a>
  </p>
</div>

				<script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
<!-- 文档结尾内嵌 -->
<ins class="adsbygoogle"
    style="display:block"
    data-ad-client="ca-pub-2572770204602497"
    data-ad-slot="5446239318"
    data-ad-format="auto"
    data-full-width-responsive="true"></ins>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script>
			</div>
		</div>
	</section>

	</div>
	<svg style="display:none">
		<symbol id="icon-dir"><svg viewBox="0 0 20 20"><path d="M15 10c0 .3-.305.515-.305.515l-8.56 5.303c-.625.41-1.135.106-1.135-.67V4.853c0-.777.51-1.078 1.135-.67l8.56 5.305S15 9.702 15 10z"/></svg></symbol>
	  </svg>
</body>
</html>
